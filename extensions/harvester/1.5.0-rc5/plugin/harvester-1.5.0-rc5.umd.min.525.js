(("undefined"!==typeof self?self:this)["webpackChunkharvester_1_5_0_rc5"]=("undefined"!==typeof self?self:this)["webpackChunkharvester_1_5_0_rc5"]||[]).push([[525],{78090:function(e,t,a){"use strict";a.d(t,{A:function(){return p}});var o=a(9274);const l={key:0,class:"label"},s={class:"text-label"},r={class:"value"};function n(e,t,a,n,i,d){return d.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.renderSlot)(e.$slots,"name",{},(()=>[(0,o.createTextVNode)((0,o.toDisplayString)(a.name),1)]),!0)]),(0,o.createElementVNode)("div",r,[(0,o.renderSlot)(e.$slots,"value",{},(()=>[(0,o.createTextVNode)((0,o.toDisplayString)(d.displayValue),1)]),!0)])])):(0,o.renderSlot)(e.$slots,"default",{key:1},void 0,!0)}var i=a(71779),d={name:"InputOrDisplay",props:{name:{type:String,required:!0},value:{type:[Number,String,Array,void 0],default:""},mode:{type:String,default:"edit"}},computed:{isView(){return this.mode===i.nW},displayValue(){return Array.isArray(this.value)&&0===this.value.length?"":this.value}}},u=(a(59335),a(47433));const c=(0,u.A)(d,[["render",n],["__scopeId","data-v-4d61bb36"]]);var p=c},92552:function(e,t,a){"use strict";a.d(t,{A:function(){return c}});var o=a(9274);const l={class:"label"},s={class:"text-label"},r={class:"value"};function n(e,t,a,n,i,d){return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.renderSlot)(e.$slots,"name",{},(()=>[(0,o.createTextVNode)((0,o.toDisplayString)(a.name),1)]),!0)]),(0,o.createElementVNode)("div",r,[(0,o.renderSlot)(e.$slots,"value",{},(()=>[(0,o.createTextVNode)((0,o.toDisplayString)(a.value),1)]),!0)])])}var i={props:{name:{type:String,required:!0},value:{type:[Number,String,void 0],default:""}}},d=(a(41347),a(47433));const u=(0,d.A)(i,[["render",n],["__scopeId","data-v-7bbb54b8"]]);var c=u},85905:function(e,t,a){"use strict";a.d(t,{A:function(){return j}});var o=a(9274);const l={class:"key-value"},s={key:0,class:"clearfix"},r={key:0,class:"icon icon-info"},n=["aria-rowcount","aria-colcount"],i={key:0,class:"rowgroup"},d={class:"row"},u={class:"text-label",role:"columnheader"},c={key:0,class:"icon icon-info",tabindex:"0"},p={class:"text-label",role:"columnheader"},m={key:1,class:"rowgroup"},v={class:"row"},h=["aria-rowindex"],f=["onUpdate:modelValue","disabled","placeholder","data-testid","aria-label","onPaste"],y=["data-testid","aria-rowindex"],g={key:0},b={key:1},k=["onUpdate:modelValue","disabled","type","placeholder","data-testid","aria-label"],w=["aria-rowindex","aria-colindex"],N=["aria-rowindex","aria-colindex","data-testid"],E=["disabled","aria-label","onClick"],V={key:1,class:"footer mt-20"},S=["disabled","aria-label"];function C(e,t,a,C,x,B){const U=(0,o.resolveComponent)("Select"),A=(0,o.resolveComponent)("CodeMirror"),M=(0,o.resolveComponent)("TextAreaAutoGrow"),T=(0,o.resolveComponent)("FileSelector"),I=(0,o.resolveDirective)("clean-tooltip"),L=(0,o.resolveDirective)("stripped-aria-label");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[a.title||e.$slots.title?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.renderSlot)(e.$slots,"title",{},(()=>[(0,o.createElementVNode)("h3",null,[(0,o.createTextVNode)((0,o.toDisplayString)(a.title)+" ",1),a.titleProtip?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("i",r,null,512)),[[I,a.titleProtip]]):(0,o.createCommentVNode)("",!0)])]))])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",{class:"kv-container",role:"grid","aria-rowcount":x.rows.length,"aria-colcount":a.extraColumns.length+2,style:(0,o.normalizeStyle)(B.containerStyle)},[x.rows.length||B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("label",u,[(0,o.createTextVNode)((0,o.toDisplayString)(B._keyLabel)+" ",1),B._protip&&!B.isView&&a.addAllowed?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("i",c,null,512)),[[I,{content:B._protip,triggers:["hover","touch","focus"]}],[L,B._protip]]):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("label",p,(0,o.toDisplayString)(B._valueLabel),1),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.extraColumns,((t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)("label",{key:a,role:"columnheader"},[(0,o.renderSlot)(e.$slots,"label:"+t,{},(()=>[(0,o.createTextVNode)((0,o.toDisplayString)(t),1)]))])))),128)),B.canRemove?(0,o.renderSlot)(e.$slots,"remove",{key:0},(()=>[t[3]||(t[3]=(0,o.createElementVNode)("span",null,null,-1))])):(0,o.createCommentVNode)("",!0)])])):(0,o.createCommentVNode)("",!0),!x.rows.length&&B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,t[4]||(t[4]=[(0,o.createElementVNode)("div",{class:"row"},[(0,o.createElementVNode)("div",{class:"kv-item key text-muted",role:"gridcell"}," — "),(0,o.createElementVNode)("div",{class:"kv-item key text-muted",role:"gridcell"}," — ")],-1)]))):((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,{key:2},(0,o.renderList)(x.rows,((l,s)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:s,class:(0,o.normalizeClass)(["rowgroup",{hide:B.isProtected(l.key)&&!a.toggleFilter}])},[(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",{class:"kv-item key",role:"gridcell","aria-rowindex":s+1,"aria-colindex":1},[(0,o.renderSlot)(e.$slots,"key",{row:l,mode:a.mode,keyName:a.keyName,valueName:a.valueName,queueUpdate:e.queueUpdate,disabled:a.disabled},(()=>[a.keyOptions?((0,o.openBlock)(),(0,o.createBlock)(U,{key:0,ref_for:!0,ref:"key",value:l[a.keyName],"onUpdate:value":[e=>l[a.keyName]=e,e.queueUpdate],searchable:!0,disabled:a.disabled||B.isProtected(l.key),clearable:!1,taggable:a.keyTaggable,options:B.calculateOptions(l[a.keyName]),"data-testid":`select-kv-item-key-${s}`,"aria-label":e.t("generic.ariaLabel.key",{index:s})},null,8,["value","onUpdate:value","disabled","taggable","options","data-testid","aria-label"])):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,ref_for:!0,ref:"key","onUpdate:modelValue":e=>l[a.keyName]=e,disabled:B.isView||a.disabled||!a.keyEditable||B.isProtected(l.key),placeholder:B._keyPlaceholder,"data-testid":`input-kv-item-key-${s}`,"aria-label":e.t("generic.ariaLabel.key",{index:s}),onInput:t[0]||(t[0]=(...t)=>e.queueUpdate&&e.queueUpdate(...t)),onPaste:e=>B.onPaste(s,e)},null,40,f)),[[o.vModelText,l[a.keyName]]])]))],8,h),(0,o.createElementVNode)("div",{"data-testid":`kv-item-value-${s}`,class:"kv-item value",role:"gridcell","aria-rowindex":s+1,"aria-colindex":2},[(0,o.renderSlot)(e.$slots,"value",{row:l,mode:a.mode,keyName:a.keyName,valueName:a.valueName,queueUpdate:e.queueUpdate},(()=>[l.supported?l.binary?((0,o.openBlock)(),(0,o.createElementBlock)("div",b,(0,o.toDisplayString)(B.binaryTextSize(l.value)),1)):((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:2,class:(0,o.normalizeClass)(["value-container",{"upload-button":a.parseValueFromFile}])},[a.valueMarkdownMultiline?((0,o.openBlock)(),(0,o.createBlock)(A,{key:0,ref_for:!0,ref:"cm","data-testid":"code-mirror-multiline-field",class:(0,o.normalizeClass)({["focus"]:x.codeMirrorFocus[s]}),value:l[a.valueName],"as-text-area":!0,mode:a.mode,options:{screenReaderLabel:e.t("generic.ariaLabel.value",{index:s})},onOnInput:e=>B.onInputMarkdownMultiline(s,e),onOnFocus:e=>B.onFocusMarkdownMultiline(s,e)},null,8,["class","value","mode","options","onOnInput","onOnFocus"])):a.valueMultiline&&void 0!==l[a.valueName]?((0,o.openBlock)(),(0,o.createBlock)(M,{key:1,value:l[a.valueName],"onUpdate:value":[e=>l[a.valueName]=e,e.queueUpdate],"data-testid":"value-multiline",class:(0,o.normalizeClass)({conceal:a.valueConcealed}),disabled:a.disabled||B.isProtected(l.key),mode:a.mode,placeholder:B._valuePlaceholder,"min-height":40,spellcheck:!1,"aria-label":e.t("generic.ariaLabel.value",{index:s})},null,8,["value","onUpdate:value","class","disabled","mode","placeholder","aria-label"])):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:2,"onUpdate:modelValue":e=>l[a.valueName]=e,disabled:B.isView||a.disabled||B.isProtected(l.key),type:a.valueConcealed?"password":"text",placeholder:B._valuePlaceholder,autocorrect:"off",autocapitalize:"off",spellcheck:"false","data-testid":`input-kv-item-value-${s}`,"aria-label":e.t("generic.ariaLabel.value",{index:s}),onInput:t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,k)),[[o.vModelDynamic,l[a.valueName]]]),a.parseValueFromFile&&a.readAllowed&&!B.isView&&B.isValueFieldEmpty(l[a.valueName])?((0,o.openBlock)(),(0,o.createBlock)(T,{key:3,class:"btn btn-sm role-secondary file-selector",label:e.t("generic.upload"),"include-file-name":!0,"aria-label":e.t("generic.ariaLabel.value",{index:s}),onSelected:e=>B.onValueFileSelected(s,e)},null,8,["label","aria-label","onSelected"])):(0,o.createCommentVNode)("",!0)],2)):((0,o.openBlock)(),(0,o.createElementBlock)("div",g,(0,o.toDisplayString)(e.t("detailText.unsupported",null,!0)),1))]))],8,y),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.extraColumns,((t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:`${s}-${a}`,class:"kv-item extra",role:"gridcell","aria-rowindex":s+1,"aria-colindex":a+3},[(0,o.renderSlot)(e.$slots,"col:"+t,{row:l,queueUpdate:e.queueUpdate,i:s})],8,w)))),128)),B.canRemove?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:s,class:"kv-item remove",role:"gridcell","aria-rowindex":s+1,"aria-colindex":a.extraColumns.length+3,"data-testid":`remove-column-${s}`},[(0,o.renderSlot)(e.$slots,"removeButton",{remove:B.remove,row:l,i:s},(()=>[(0,o.createElementVNode)("button",{type:"button",role:"button",disabled:B.isView||B.isProtected(l.key)||a.disabled,"aria-label":`${a.removeLabel||e.t("generic.remove")} ${s+1}`,class:"btn role-link",onClick:e=>B.remove(s)},(0,o.toDisplayString)(a.removeLabel||e.t("generic.remove")),9,E)]))],8,N)):(0,o.createCommentVNode)("",!0)])],2)))),128))],12,n),!a.addAllowed&&!a.readAllowed||B.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",V,[(0,o.renderSlot)(e.$slots,"add",{add:B.add},(()=>[a.addAllowed?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",role:"button",class:"btn role-tertiary add","data-testid":"add_row_item_button",disabled:a.loading||a.disabled||a.keyOptions&&0===B.filteredKeyOptions.length,"aria-label":B._addLabel,onClick:t[2]||(t[2]=e=>B.add())},[(0,o.createElementVNode)("i",{class:(0,o.normalizeClass)(["mr-5 icon",a.loading?["icon-lg","icon-spinner","icon-spin"]:[a.addIcon]])},null,2),(0,o.createTextVNode)(" "+(0,o.toDisplayString)(B._addLabel),1)],8,S)):(0,o.createCommentVNode)("",!0),a.readAllowed?((0,o.openBlock)(),(0,o.createBlock)(T,{key:1,disabled:B.isView,class:"role-tertiary",label:e.t("generic.readFromFile"),"include-file-name":!0,onSelected:B.onFileSelected},null,8,["disabled","label","onSelected"])):(0,o.createCommentVNode)("",!0)]))]))])}var x=a(40833),B=a.n(x),U=a(73331),A=a(26812),M=a(17146),T=a(96135),I=a(57848),L=a(92590),O=a(44863),$=a(64779),_=a(71779),D=a(41594),P=a(97815),q=a(7512),R=a.n(q),F={name:"KeyValue",emits:["focusKey","update:value"],components:{CodeMirror:P.A,Select:O.A,TextAreaAutoGrow:I.V,FileSelector:$.A},props:{value:{type:[Array,Object],default:null},defaultValue:{type:[Array,Object],default:null},binaryValueKeys:{type:[Array,Object],default:null},mode:{type:String,default:_.G5},asMap:{type:Boolean,default:!0},initialEmptyRow:{type:Boolean,default:!1},title:{type:String,default:""},titleProtip:{type:String,default:""},protip:{type:[String,Boolean],default:""},keyName:{type:String,default:"key"},keyLabel:{type:String,default:""},keyEditable:{type:Boolean,default:!0},keyOptions:{type:Array,default:null},keyTaggable:{type:Boolean,default:!0},keyOptionUnique:{type:Boolean,default:!1},keyPlaceholder:{type:String,default:""},protectedKeys:{type:Array,default:()=>[]},toggleFilter:{type:Boolean,default:!1},separatorLabel:{type:String,default:""},valueName:{type:String,default:"value"},valueLabel:{type:String,default:""},valuePlaceholder:{type:String,default:""},valueCanBeEmpty:{type:Boolean,default:!1},displayValuesAsBinary:{type:Boolean,default:!1},valueMarkdownMultiline:{type:Boolean,default:!1},valueMultiline:{type:Boolean,default:!0},valueTrim:{type:Boolean,default:!0},handleBase64:{type:Boolean,default:!1},valueConcealed:{type:Boolean,default:!1},supported:{type:Function,default:e=>!0},preserveKeys:{type:Array,default:null},extraColumns:{type:Array,default:()=>[]},defaultAddData:{type:Object,default:()=>{}},addLabel:{type:String,default:""},addIcon:{type:String,default:""},addAllowed:{type:Boolean,default:!0},readIcon:{type:String,default:"icon-upload"},readAllowed:{type:Boolean,default:!0},readAccept:{type:String,default:"*"},readMultiple:{type:Boolean,default:!1},removeLabel:{type:String,default:""},removeIcon:{type:String,default:"icon-minus"},removeAllowed:{type:Boolean,default:!0},fileModifier:{type:Function,default:(e,t)=>({name:e,value:t})},parserSeparators:{type:Array,default:()=>[":","="]},loading:{default:!1,type:Boolean},parseLinesFromFile:{default:!1,type:Boolean},parseValueFromFile:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean}},data(){const e=this.getRows(this.value);return{rows:e,codeMirrorFocus:{},lastUpdated:null}},computed:{_protip(){return this.protip||this.t("keyValue.protip",null,!0)},_keyLabel(){return this.keyLabel||this.t("generic.key")},_keyPlaceholder(){return this.keyPlaceholder||this.t("keyValue.keyPlaceholder")},_valueLabel(){return this.valueLabel||this.t("generic.value")},_valuePlaceholder(){return this.valuePlaceholder||this.t("keyValue.valuePlaceholder")},_addLabel(){return this.addLabel||this.t("generic.add")},isView(){return this.mode===_.nW},containerStyle(){const e=this.canRemove?" 50px":"",t=2+this.extraColumns.length;return`grid-template-columns: repeat(${t}, 1fr)${e};`},usedKeyOptions(){return this.rows.map((e=>e[this.keyName]))},filteredKeyOptions(){return this.keyOptionUnique?this.keyOptions.filter((e=>!this.usedKeyOptions.includes(e.value))):this.keyOptions},canRemove(){return!this.isView&&this.removeAllowed}},created(){this.queueUpdate=B()(this.update,500)},watch:{value:{deep:!0,handler(e,t){this.valuePropChanged(e,t)}}},methods:{valuePropChanged(e){R()(e,this.lastUpdated)||(this.rows=this.getRows(e))},isProtected(e){return this.protectedKeys&&this.protectedKeys.includes(e)},getRows(e){const t=[];if(this.asMap){const a=e||{};Object.keys(a).forEach((e=>{let o=a[e];const l=(0,M.u)(a[e]),s=(0,D.XC)(l);this.handleBase64&&s&&(o=(0,M.u)(o)),t.push({key:e,value:o,binary:this.displayValuesAsBinary||this.handleBase64&&!s,canEncode:this.handleBase64&&s,supported:!0})}))}else{const a=e||[];for(const e of a){let a=e[this.valueName]||"";const o=(0,M.u)(e[this.valueName]),l=(0,D.XC)(o);this.handleBase64&&l&&(a=(0,M.u)(a));const s={[this.keyName]:e[this.keyName]||"",[this.valueName]:a,binary:this.displayValuesAsBinary||this.handleBase64&&!l,canEncode:this.handleBase64&&l,supported:this.supported(e)};this.preserveKeys?.map((t=>{"undefined"!==typeof e[t]&&(s[t]=e[t])})),t.push(s)}}return t&&!t.length&&this.initialEmptyRow&&t.push({[this.keyName]:"",[this.valueName]:"",binary:!1,canEncode:this.handleBase64,supported:!0}),t},add(e="",t=""){const a={...this.defaultAddData,[this.keyName]:e,[this.valueName]:t};a.binary=!1,a.canEncode=this.handleBase64,a.supported=!0,this.rows.push(a),this.queueUpdate(),this.$nextTick((()=>{if(this.$refs.key){const e=this.$refs.key,t=e[e.length-1];t.focus()}else this.$emit("focusKey")}))},remove(e){(0,A.Wq)(this.rows,e),this.queueUpdate()},removeEmptyRows(){const e=this.rows.filter((e=>e.value.length||e.key.length));this["rows"]=e},onFileSelected(e){const{name:t,value:a}=this.fileModifier(e.name,e.value);if(this.parseLinesFromFile){const e=a.split("\n");e.forEach((e=>{if(e.length){const[t,a]=e.split("=");this.add(t,a)}})),e.length>0&&this.removeEmptyRows()}else this.add(t,a,this.displayValuesAsBinary)},download(e,t){const a=this.rows[e],o=a[this.keyName],l=a[this.valueName];(0,T.PE)(o,l,"application/octet-stream")},update(){let e;if(this.asMap){e={};const t=this.keyName,a=this.valueName;for(const o of this.rows){let l=o[a]||"";const s=(o[t]||"").trim();l&&"object"===(0,U.QP)(l)?e[s]=JSON.parse(JSON.stringify(l)):(l=l||"",this.valueTrim&&(0,D.XC)(l)&&(l=l.trim()),o.canEncode&&(l=(0,M.KA)(l)),s&&(l||this.valueCanBeEmpty)&&(e[s]=l))}}else{const t=this.preserveKeys||[];(0,A.Gj)(t,this.keyName),(0,A.Gj)(t,this.valueName),e=this.rows.map((e=>{let a=e[this.valueName];e.canEncode&&(a=(0,M.KA)(a));const o={[this.keyName]:e[this.keyName],[this.valueName]:a};for(const l of t)"undefined"!==typeof e[l]&&(o[l]=e[l]);return o}))}this.lastUpdated=e,this.$emit("update:value",e)},onPaste(e,t){const a=t.clipboardData.getData("text/plain"),o=a.split("\n"),l=o.map((e=>{const t=this.parserSeparators.find((t=>e.includes(t)));return t?e.split(t):""})).filter((e=>e&&e.length>0));if(0===l.length||1===l.length&&l[0].length<2)return;t.preventDefault();const s=l.map((e=>({[this.keyName]:(e[0]||"").trim(),[this.valueName]:(e[1]||"").trim(),supported:!0,canEncode:this.handleBase64,binary:this.displayValuesAsBinary})));this.rows.splice(e,1,...s),this.queueUpdate()},calculateOptions(e){const t=this.keyOptions.find((t=>t.value===e));return t?[t,...this.filteredKeyOptions]:this.filteredKeyOptions},binaryTextSize(e){const t=this.handleBase64?(0,M.u)(e):e,a=e.length?(0,M.dQ)(t):0;return this.t("detailText.binary",{n:a},!0)},get:L.Jt,onInputMarkdownMultiline(e,t){this.rows=this.rows.map(((a,o)=>o===e?{...a,value:t}:a)),this.queueUpdate()},onFocusMarkdownMultiline(e,t){this.codeMirrorFocus[e]=t},onValueFileSelected(e,t){const{name:a,value:o}=t;this.rows[e][this.keyName]||(this.rows[e][this.keyName]=a),this.rows[e][this.valueName]=o},isValueFieldEmpty(e){return!e||0===e.trim().length}}},K=(a(51403),a(47433));const z=(0,K.A)(F,[["render",C]]);var j=z},55659:function(e,t,a){"use strict";a.d(t,{A:function(){return w}});var o=a(9274);const l={class:"labels"},s={class:"labels__header"},r={key:0},n={class:"mt-10 mb-10"};function i(e,t,a,i,d,u){const c=(0,o.resolveComponent)("t"),p=(0,o.resolveComponent)("ToggleSwitch"),m=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(u.containerClass)},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(a.defaultSectionClass)},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[a.showLabelTitle?((0,o.openBlock)(),(0,o.createElementBlock)("h3",r,[(0,o.createVNode)(c,{k:"labels.labels.title"})])):(0,o.createCommentVNode)("",!0),a.value.hasSystemLabels?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,value:d.toggler,"onUpdate:value":t[0]||(t[0]=e=>d.toggler=e),name:"label-system-toggle","on-label":e.t("labels.labels.show")},null,8,["value","on-label"])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("p",n,[(0,o.createVNode)(c,{k:"labels.labels.description"})]),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(u.columnsClass)},[(0,o.renderSlot)(e.$slots,"labels",{toggler:d.toggler},(()=>[(0,o.createVNode)(m,{key:"labels",value:a.value.labels,"protected-keys":a.value.systemLabels||[],"toggle-filter":d.toggler,"add-label":e.t("labels.addLabel"),"add-icon":a.addIcon,mode:a.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[1]||(t[1]=e=>a.value.setLabels(e))},null,8,["value","protected-keys","toggle-filter","add-label","add-icon","mode"])]),!0)],2)])],2),t[3]||(t[3]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),a.showAnnotations?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,class:(0,o.normalizeClass)(u.sectionClass)},[(0,o.createVNode)(m,{key:"annotations",value:a.value.annotations,"add-label":e.t("labels.addAnnotation"),"add-icon":a.addIcon,mode:a.mode,"protected-keys":a.value.systemAnnotations||[],"toggle-filter":d.toggler,title:e.t("labels.annotations.title"),"title-protip":a.annotationTitleTooltip,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[2]||(t[2]=e=>a.value.setAnnotations(e))},null,8,["value","add-label","add-icon","mode","protected-keys","toggle-filter","title","title-protip"])],2)):(0,o.createCommentVNode)("",!0)],2)}var d=a(85905);const u={class:"toggle-container"},c={class:"switch hand"},p=["checked","aria-label"],m={ref:"switchChrome",class:"slider round"};function v(e,t,a,l,s,r){return(0,o.openBlock)(),(0,o.createElementBlock)("span",u,[(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)(["label no-select hand",{active:!e.state}]),onClick:t[0]||(t[0]=t=>e.toggle(!1))},(0,o.toDisplayString)(e.offLabel),3),(0,o.createElementVNode)("label",c,[(0,o.createElementVNode)("input",{ref:"switchInput",type:"checkbox",role:"switch",checked:e.state,"aria-label":e.onLabel,onInput:t[1]||(t[1]=t=>e.toggle(null)),onKeydown:t[2]||(t[2]=(0,o.withKeys)((t=>e.toggle(null)),["enter"]))},null,40,p),(0,o.createElementVNode)("span",m,null,512)]),(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)(["label no-select hand",{active:e.state}]),onClick:t[3]||(t[3]=t=>e.toggle(!0))},(0,o.toDisplayString)(e.onLabel),3)])}var h=(0,o.defineComponent)({props:{value:{type:[Boolean,String,Number],default:!1},offValue:{type:[Boolean,String,Number],default:!1},onValue:{type:[Boolean,String,Number],default:!0},offLabel:{type:String,default:""},onLabel:{type:String,default:""}},emits:["update:value"],setup(){const e=(0,o.ref)(null),t=()=>{var t;null===(t=e.value)||void 0===t||t.classList.add("focus")},a=()=>{var t;null===(t=e.value)||void 0===t||t.classList.remove("focus")},l=(0,o.ref)(null);(0,o.onMounted)((()=>{var e,o;null===(e=l.value)||void 0===e||e.addEventListener("focus",t),null===(o=l.value)||void 0===o||o.addEventListener("blur",a)})),(0,o.onBeforeUnmount)((()=>{var e,o;null===(e=l.value)||void 0===e||e.removeEventListener("focus",t),null===(o=l.value)||void 0===o||o.removeEventListener("blur",a)}))},data(){return{state:!1}},watch:{value:{handler(){this.state=this.value===this.onValue},immediate:!0}},methods:{toggle(e){this.state=null===e?!this.state:e,this.$emit("update:value",this.state?this.onValue:this.offValue)}}}),f=(a(52124),a(47433));const y=(0,f.A)(h,[["render",v],["__scopeId","data-v-2d3cf8f2"]]);var g=y,b={components:{ToggleSwitch:g,KeyValue:d.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},displaySideBySide:{type:Boolean,default:!1},defaultContainerClass:{type:String,default:""},defaultSectionClass:{type:String,default:""},labelTitleTooltip:{type:String,default:""},annotationTitleTooltip:{type:String,default:""},showAnnotations:{type:Boolean,default:!0},showLabelTitle:{type:Boolean,default:!0},addIcon:{type:String,default:""}},data(){return{toggler:!1}},computed:{containerClass(){return`${this.displaySideBySide?"row":""} ${this.defaultContainerClass}`.trim()},sectionClass(){return`${this.displaySideBySide?"col span-6":"row"} ${this.defaultSectionClass}`.trim()},columnsClass(){return(""+(this.displaySideBySide?"col span-6":"row")).trim()}}};a(21292);const k=(0,f.A)(b,[["render",i],["__scopeId","data-v-bcf64458"]]);var w=k},26855:function(e,t,a){"use strict";a.d(t,{A:function(){return A}});var o=a(9274);const l={key:0},s=["data-testid"],r={key:0},n=["data-testid"],i={key:0},d=["onUpdate:modelValue","mode","data-testid"],u=["data-testid"],c={key:0},p={key:1,class:"no-value"},m=["data-testid"],v={key:0},h=["onUpdate:modelValue","mode","disabled","data-testid"],f={key:3,class:"remove-container"},y=["disabled","data-testid","onClick"],g={key:3,class:"mt-20"};function b(e,t,a,b,k,w){const N=(0,o.resolveComponent)("LabeledSelect"),E=(0,o.resolveComponent)("Select"),V=(0,o.resolveComponent)("t");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[k.rules.length?(0,o.renderSlot)(e.$slots,"header",{key:0},void 0,!0):(0,o.createCommentVNode)("",!0),a.showRemove&&!w.isView?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"btn role-link remove-expression",onClick:t[0]||(t[0]=t=>e.$emit("remove"))},t[4]||(t[4]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]))):(0,o.createCommentVNode)("",!0),k.rules.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:2,class:(0,o.normalizeClass)(["match-expression-header",{view:w.isView,"match-expression-header-matching":a.matchingSelectorDisplay}])},[a.matchingSelectorDisplay?((0,o.openBlock)(),(0,o.createElementBlock)("label",l,(0,o.toDisplayString)(e.t("workload.scheduling.affinity.matchExpressions.matchType")),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(e.t("workload.scheduling.affinity.matchExpressions.key")),1),(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(e.t("workload.scheduling.affinity.matchExpressions.operator")),1),(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(e.t("workload.scheduling.affinity.matchExpressions.value")),1),t[5]||(t[5]=(0,o.createElementVNode)("span",null,null,-1))],2)):(0,o.createCommentVNode)("",!0),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(k.rules,((e,l)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:l,class:(0,o.normalizeClass)(["match-expression-row",{view:w.isView,"mb-10":l!==k.rules.length-1,"match-expression-row-matching":a.matchingSelectorDisplay}])},[a.matchingSelectorDisplay?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,"data-testid":`input-match-type-field-${l}`},[w.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,(0,o.toDisplayString)(e.matching),1)):((0,o.openBlock)(),(0,o.createBlock)(N,{key:1,value:e.matching,"onUpdate:value":t=>e.matching=t,mode:a.mode,options:w.matchingSelectOptions,"data-testid":`input-match-type-field-control-${l}`,onSelecting:w.update},null,8,["value","onUpdate:value","mode","options","data-testid","onSelecting"]))],8,s)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",{"data-testid":`input-match-expression-key-${l}`},[w.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,(0,o.toDisplayString)(e.key),1)):w.hasKeySelectOptions?((0,o.openBlock)(),(0,o.createBlock)(N,{key:2,value:e.key,"onUpdate:value":t=>e.key=t,mode:a.mode,options:a.keysSelectOptions,"data-testid":`input-match-expression-key-control-select-${l}`},null,8,["value","onUpdate:value","mode","options","data-testid"])):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":t=>e.key=t,mode:a.mode,"data-testid":`input-match-expression-key-control-${l}`,onInput:t[1]||(t[1]=(...e)=>w.update&&w.update(...e))},null,40,d)),[[o.vModelText,e.key]])],8,n),(0,o.createElementVNode)("div",{"data-testid":`input-match-expression-operator-${l}`},[w.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,(0,o.toDisplayString)(e.operator),1)):((0,o.openBlock)(),(0,o.createBlock)(E,{key:1,value:e.operator,"onUpdate:value":[t=>e.operator=t,w.update],class:"operator single",options:k.ops,clearable:!1,reduce:e=>e.value,mode:a.mode,"data-testid":`input-match-expression-operator-control-${l}`},null,8,["value","onUpdate:value","options","reduce","mode","data-testid"]))],8,u),"Exists"===e.operator||"DoesNotExist"===e.operator?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,t[6]||(t[6]=[(0,o.createElementVNode)("label",{class:"text-muted"},"…",-1)]))):((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:2,"data-testid":`input-match-expression-values-${l}`},[w.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,(0,o.toDisplayString)(e.values),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":t=>e.values=t,mode:a.mode,disabled:"Exists"===e.operator||"DoesNotExist"===e.operator,"data-testid":`input-match-expression-values-control-${l}`,onInput:t[2]||(t[2]=(...e)=>w.update&&w.update(...e))},null,40,h)),[[o.vModelText,e.values]])],8,m)),a.showRemoveButton?((0,o.openBlock)(),(0,o.createElementBlock)("div",f,[w.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-link",style:{padding:"0px"},disabled:"view"===a.mode,"data-testid":`input-match-expression-remove-control-${l}`,onClick:t=>w.removeRule(e)},[(0,o.createVNode)(V,{k:"generic.remove"})],8,y))])):(0,o.createCommentVNode)("",!0)],2)))),128)),!w.isView&&a.showAddButton?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-tertiary add","data-testid":"input-match-expression-add-rule",onClick:t[3]||(t[3]=(...e)=>w.addRule&&w.addRule(...e))},[(0,o.createVNode)(V,{k:"workload.scheduling.affinity.matchExpressions.addRule"})])])):(0,o.createCommentVNode)("",!0)])}var k=a(20665),w=a(44863),N=a(24466),E=a(26812),V=a(92590),S=a(17678),C=a(77562),x={emits:["update:value","remove"],components:{Select:w.A,LabeledSelect:C.A},props:{value:{type:[Array,Object],default:()=>[]},mode:{type:String,default:"edit"},type:{type:String,default:k.NW},matchingSelectorDisplay:{type:Boolean,default:!1},initialEmptyRow:{type:Boolean,default:!1},showAddButton:{type:Boolean,default:!0},showRemoveButton:{type:Boolean,default:!0},showRemove:{type:Boolean,default:!0},keysSelectOptions:{type:Array,default:()=>[]}},data(){return{ops:[],rules:[],custom:[]}},created(){const e=this.$store.getters["i18n/t"],t=[{label:e("workload.scheduling.affinity.matchExpressions.in"),value:"In"},{label:e("workload.scheduling.affinity.matchExpressions.notIn"),value:"NotIn"},{label:e("workload.scheduling.affinity.matchExpressions.exists"),value:"Exists"},{label:e("workload.scheduling.affinity.matchExpressions.doesNotExist"),value:"DoesNotExist"}],a=[{label:e("workload.scheduling.affinity.matchExpressions.in"),value:"In"},{label:e("workload.scheduling.affinity.matchExpressions.notIn"),value:"NotIn"},{label:e("workload.scheduling.affinity.matchExpressions.exists"),value:"Exists"},{label:e("workload.scheduling.affinity.matchExpressions.doesNotExist"),value:"DoesNotExist"},{label:e("workload.scheduling.affinity.matchExpressions.lessThan"),value:"Lt"},{label:e("workload.scheduling.affinity.matchExpressions.greaterThan"),value:"Gt"}];let o;if(this.matchingSelectorDisplay){const e={matchFields:[],matchExpressions:[]};["matchFields","matchExpressions"].forEach((t=>{e[t]=this.parseRules(this.value[t],t)})),o=[...e.matchFields,...e.matchExpressions]}else(0,E.cy)(this.value)?(o=[...this.value],o=this.parseRules(o)):(o=(0,S.C6)(this.value.matchLabels,this.value.matchExpressions),o=this.parseRules(o));if(!o.length&&this.initialEmptyRow&&!this.isView){const e={key:"",operator:"In",values:""};this.matchingSelectorDisplay&&(e.matching="matchExpressions"),o.push(e)}this.rules=o,this.ops=this.type===k.NW?a:t},computed:{isView(){return"view"===this.mode},node(){return k.NW},pod(){return k.Sm},hasKeySelectOptions(){return!!this.keysSelectOptions?.length},matchingSelectOptions(){return[{label:this.t("workload.scheduling.affinity.matchExpressions.label"),value:"matchExpressions"},{label:this.t("workload.scheduling.affinity.matchFields.label"),value:"matchFields"}]},...(0,N.L8)({t:"i18n/t"})},methods:{parseRules(e,t){return e?.length?e.map((e=>{const a=(0,V.o8)(e);return a.values&&"string"!==typeof a.values&&(a.values=a.values.join(", ")),t&&(a.matching=t),a})):[]},removeRule(e){(0,E.Gj)(this.rules,e),this.update()},addRule(){const e={key:"",operator:"In",values:""};this.matchingSelectorDisplay&&(e.matching="matchExpressions"),this.rules.push(e)},update(){this.$nextTick((()=>{const e=this.rules.map((e=>{const t={key:e.key,operator:e.operator};this.matchingSelectorDisplay&&(t.matching=e.matching);let a=(e.values||"").trim();return"Exists"!==e.operator&&"DoesNotExist"!==e.operator||(a=null),null!==a&&(t.values=a.split(/\s*,\s*/)),t})).filter((e=>!!e));(0,E.cy)(this.value)||this.matchingSelectorDisplay?this.$emit("update:value",e):this.$emit("update:value",(0,S.CR)(e))}))}}},B=(a(22281),a(47433));const U=(0,B.A)(x,[["render",b],["__scopeId","data-v-7b79099a"]]);var A=U},15319:function(e,t,a){"use strict";a.d(t,{A:function(){return I}});var o=a(9274);const l={class:"row mb-20"},s={key:0,class:"row"},r={class:"col span-6"};function n(e,t,a,n,i,d){const u=(0,o.resolveComponent)("RadioGroup"),c=(0,o.resolveComponent)("LabeledSelect"),p=(0,o.resolveComponent)("NodeAffinity");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(u,{value:i.selectNode,"onUpdate:value":t[0]||(t[0]=e=>i.selectNode=e),name:"selectNode",options:d.selectNodeOptions,mode:a.mode,"data-testid":"node-scheduling-selectNode",onInput:d.update},null,8,["value","options","mode","onInput"])]),"nodeSelector"===i.selectNode?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:i.nodeName,"onUpdate:value":[t[1]||(t[1]=e=>i.nodeName=e),d.update],label:e.t("workload.scheduling.affinity.nodeName"),options:a.nodes||[],mode:a.mode,multiple:!1,loading:a.loading,"data-testid":"node-scheduling-nodeSelector"},null,8,["value","label","options","mode","loading","onUpdate:value"])])])):"affinity"===i.selectNode?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,value:i.nodeAffinity,"onUpdate:value":t[2]||(t[2]=e=>i.nodeAffinity=e),mode:a.mode,"data-testid":"node-scheduling-nodeAffinity",onInput:d.update},null,8,["value","mode","onInput"])):(0,o.createCommentVNode)("",!0)])}var i=a(24466),d=a(21221),u=a(77562);const c={class:"col span-12"},p={class:"row"},m={class:"col span-9"},v={key:0,class:"col span-3"};function h(e,t,a,l,s,r){const n=(0,o.resolveComponent)("LabeledSelect"),i=(0,o.resolveComponent)("LabeledInput"),d=(0,o.resolveComponent)("MatchExpressions"),u=(0,o.resolveComponent)("ArrayListGrouped");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"row","onUpdate:value":t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(u,{value:s.allSelectorTerms,"onUpdate:value":t[0]||(t[0]=e=>s.allSelectorTerms=e),class:"mt-20",mode:a.mode,"default-add-value":{matchExpressions:[]},"add-label":e.t("workload.scheduling.affinity.addNodeSelector"),onRemove:r.remove},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createVNode)(n,{options:r.affinityOptions,value:r.priorityDisplay(t.row.value),label:e.t("workload.scheduling.affinity.priority"),mode:a.mode,"data-testid":`node-affinity-priority-index${t.i}`,"onUpdate:value":e=>r.changePriority(t.row.value)},null,8,["options","value","label","mode","data-testid","onUpdate:value"])]),"weight"in t.row.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createVNode)(i,{value:t.row.value.weight,"onUpdate:value":[e=>t.row.value.weight=e,r.update],valueModifiers:{number:!0},mode:a.mode,type:"number",min:"1",max:"100",label:e.t("workload.scheduling.affinity.weight.label"),placeholder:e.t("workload.scheduling.affinity.weight.placeholder"),"data-testid":`node-affinity-weight-index${t.i}`},null,8,["value","onUpdate:value","mode","label","placeholder","data-testid"])])):(0,o.createCommentVNode)("",!0)]),(0,o.createVNode)(d,{value:a.matchingSelectorDisplay?t.row.value:t.row.value.matchExpressions,"matching-selector-display":a.matchingSelectorDisplay,mode:a.mode,class:"col span-12 mt-20",type:r.node,"show-remove":!1,"data-testid":`node-affinity-expressions-index${t.i}`,"onUpdate:value":e=>r.updateExpressions(t.row.value,e)},null,8,["value","matching-selector-display","mode","type","data-testid","onUpdate:value"])])),_:1},8,["value","mode","add-label","onRemove"])])],32)}var f=a(40833),y=a.n(f),g=a(71779),b=a(92590),k=a(20665),w=a(26855),N=a(5327),E=a(41594),V=a(11331),S={emits:["update:value"],components:{ArrayListGrouped:V.A,MatchExpressions:w.A,LabeledSelect:u.A,LabeledInput:N.o},props:{value:{type:Object,default:()=>({})},mode:{type:String,default:"create"},matchingSelectorDisplay:{type:Boolean,default:!1}},data(){return this.value.required,{nodeSelectorTerms:null,allSelectorTerms:null,weightedNodeSelectorTerms:null,defaultWeight:1,rerenderNums:(0,E.vx)(4)}},computed:{...(0,i.L8)({t:"i18n/t"}),isView(){return this.mode===g.nW},hasWeighted(){return!!this.weightedNodeSelectorTerms},node(){return k.NW},affinityOptions(){const e=[this.t("workload.scheduling.affinity.preferred"),this.t("workload.scheduling.affinity.required")];return e}},created(){if(this.value.required)this.nodeSelectorTerms=this.value.required.nodeSelectorTerms;else{const{preferredDuringSchedulingIgnoredDuringExecution:e=[],requiredDuringSchedulingIgnoredDuringExecution:t={}}=this.value,{nodeSelectorTerms:a=[]}=t,o=[...e,...a].map((e=>{const t=(0,b.o8)(e);return t._id=(0,E.vx)(4),e.preference&&(Object.assign(t,e.preference),delete t.preference),t}));this.allSelectorTerms=o,this.weightedNodeSelectorTerms=e}this.queueUpdate=y()(this.update,500)},methods:{update(){const e={},t={nodeSelectorTerms:[]},a=[];this.allSelectorTerms.forEach((e=>{const o={...e};if(o.matchExpressions&&(o.matchExpressions=(o.matchExpressions||[]).map((e=>{const t={...e};return delete t.matching,t}))),o.matchFields&&(o.matchFields=(o.matchFields||[]).map((e=>{const t={...e};return delete t.matching,t}))),o.weight){const e={weight:o.weight,preference:o};delete e.preference.weight,a.push(e)}else t.nodeSelectorTerms.push(o)})),a.length&&(e.preferredDuringSchedulingIgnoredDuringExecution=a),t.nodeSelectorTerms.length&&(e.requiredDuringSchedulingIgnoredDuringExecution=t),this.$emit("update:value",e)},remove(){this.rerenderNums=(0,E.vx)(4),this.queueUpdate()},changePriority(e){e.weight?delete e["weight"]:e["weight"]=1,this.update()},priorityDisplay(e){return"weight"in e?this.t("workload.scheduling.affinity.preferred"):this.t("workload.scheduling.affinity.required")},updateExpressions(e,t){const a={matchFields:[],matchExpressions:[]};t.length&&(t.forEach((e=>{a[e.matching||"matchExpressions"].push(e)})),e["matchFields"]=a.matchFields,e["matchExpressions"]=a.matchExpressions,this.update())},get:b.Jt,isEmpty:b.Im}},C=a(47433);const x=(0,C.A)(S,[["render",h]]);var B=x,U=a(77673),A=a(55190),M={components:{RadioGroup:d.z,LabeledSelect:u.A,NodeAffinity:B},props:{value:{type:Object,default:()=>({})},nodes:{type:Array,default:()=>[]},mode:{type:String,default:"create"},loading:{default:!1,type:Boolean}},data(){return{selectNode:null,nodeName:"",nodeAffinity:{},nodeSelector:{}}},created(){const e=this.$store.getters["currentProduct"].inStore===U.T3;let{nodeName:t=""}=this.value;const{affinity:a={},nodeSelector:o={}}=this.value,{nodeAffinity:l={}}=a;let s=null;this.value.nodeName?s="nodeSelector":e&&this.value?.nodeSelector?.[A.yA]?(s="nodeSelector",t=o[A.yA]):(0,b.Im)(l)||(s="affinity"),l.requiredDuringSchedulingIgnoredDuringExecution||(l["requiredDuringSchedulingIgnoredDuringExecution"]={nodeSelectorTerms:[]}),l.preferredDuringSchedulingIgnoredDuringExecution||(l["preferredDuringSchedulingIgnoredDuringExecution"]=[]),this.selectNode=s,this.nodeName=t,this.nodeAffinity=l,this.nodeSelector=o},computed:{...(0,i.L8)({t:"i18n/t"}),isView(){return this.mode===g.nW},isHarvester(){return this.$store.getters["currentProduct"].inStore===U.T3},selectNodeOptions(){const e=this.isHarvester?"harvester.virtualMachine":"workload",t=[{label:this.t(`${e}.scheduling.affinity.anyNode`),value:null},{label:this.t(`${e}.scheduling.affinity.specificNode`),value:"nodeSelector"},{label:this.t(`${e}.scheduling.affinity.schedulingRules`),value:"affinity"}];return t}},methods:{update(){const{nodeName:e,nodeSelector:t,nodeAffinity:a}=this;switch(this.selectNode){case"nodeSelector":this.isHarvester?Object.assign(this.value,{nodeSelector:{[A.yA]:e}}):Object.assign(this.value,{nodeSelector:t,nodeName:e}),this.value?.affinity?.nodeAffinity&&delete this.value.affinity.nodeAffinity;break;case"affinity":delete this.value.nodeName,delete this.value.nodeSelector,this.value.affinity?Object.assign(this.value.affinity,{nodeAffinity:a}):Object.assign(this.value,{affinity:{nodeAffinity:a}});break;default:delete this.value.nodeName,delete this.value.nodeSelector,this.value?.affinity?.nodeAffinity&&delete this.value.affinity.nodeAffinity}},isEmpty:b.Im},watch:{"value.nodeSelector":{handler(e){if(this.isHarvester&&e?.[A.yA]){this.selectNode="nodeSelector";const t=e[A.yA];this.nodeName=t;const a=this.nodes.map((e=>e.value));t&&!a.includes(t)&&(this.$store.dispatch("growl/error",{title:this.$store.getters["i18n/t"]("harvester.vmTemplate.tips.notExistNode.title",{name:t}),message:this.$store.getters["i18n/t"]("harvester.vmTemplate.tips.notExistNode.message")},{root:!0}),delete this.value.nodeSelector,this["nodeName"]="",this["selectNode"]=null)}}}}};const T=(0,C.A)(M,[["render",n]]);var I=T},66888:function(e,t,a){"use strict";a.d(t,{A:function(){return y}});var o=a(9274);const l={class:"password"},s={key:0,class:"addon"},r={key:1,class:"addon"},n={key:0,class:"mt-10 genPassword"};function i(e,t,a,i,d,u){const c=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createVNode)(c,(0,o.mergeProps)({ref:"input",value:u.password,"onUpdate:value":t[3]||(t[3]=e=>u.password=e)},u.attributes,{type:a.isRandom||d.reveal?"text":"password",readonly:a.isRandom,label:a.label,required:a.required,disabled:a.isRandom,"ignore-password-managers":a.ignorePasswordManagers,mode:a.mode,onBlur:t[4]||(t[4]=t=>e.$emit("blur",t))}),{suffix:(0,o.withCtx)((()=>[a.isRandom?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("a",{href:"#",onClick:t[0]||(t[0]=(0,o.withModifiers)((e=>u.copyTextToClipboard(u.password)),["prevent","stop"]))},(0,o.toDisplayString)(e.t("action.copy")),1)])):((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("a",{href:"#",tabindex:"0",class:"hide-show",role:"button",onClick:t[1]||(t[1]=(0,o.withModifiers)(((...e)=>u.hideShowFn&&u.hideShowFn(...e)),["prevent","stop"])),onKeyup:t[2]||(t[2]=(0,o.withKeys)((0,o.withModifiers)(((...e)=>u.hideShowFn&&u.hideShowFn(...e)),["prevent","stop"]),["space"]))},(0,o.toDisplayString)(u.hideShowLabel),33)]))])),_:1},16,["value","type","readonly","label","required","disabled","ignore-password-managers","mode"]),a.isRandom?((0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("a",{href:"#",onClick:t[5]||(t[5]=(0,o.withModifiers)(((...e)=>u.generatePassword&&u.generatePassword(...e)),["prevent","stop"]))},[t[6]||(t[6]=(0,o.createElementVNode)("i",{class:"icon icon-refresh"},null,-1)),(0,o.createTextVNode)(" "+(0,o.toDisplayString)(e.t("changePassword.newGeneratedPassword")),1)])])):(0,o.createCommentVNode)("",!0)])}var d=a(24466),u=a(5327),c=a(41594),p=a(60729),m=a(71779),v={emits:["update:value","blur"],components:{LabeledInput:u.o},props:{value:{default:"",type:String},isRandom:{default:!1,type:Boolean},label:{default:"",type:String},name:{default:"",type:String},autocomplete:{type:String,default:""},required:{default:!1,type:Boolean},ignorePasswordManagers:{default:!1,type:Boolean},mode:{type:String,default:m.YQ}},data(){return{reveal:!1}},computed:{...(0,d.L8)({t:"i18n/t"}),password:{get(){return this.value},set(e){this.$emit("update:value",e)}},attributes(){const e={};return this.name&&(e.id=this.name,e.name=this.name),this.autocomplete&&(e.autocomplete=this.autocomplete),e},hideShowLabel(){return this.reveal?this.t("action.hide"):this.t("action.show")}},watch:{isRandom(){this.isRandom&&this.generatePassword()}},created(){this.isRandom&&this.generatePassword()},methods:{copyTextToClipboard:p.e,generatePassword(){this.password=(0,c.vx)(16,c.LQ.ALPHA_NUM)},show(e){this.reveal=e},focus(){this.$refs.input.$refs.value.focus()},hideShowFn(){this.reveal?this.reveal=!1:this.reveal=!0}}},h=(a(4961),a(47433));const f=(0,h.A)(v,[["render",i],["__scopeId","data-v-39697410"]]);var y=f},32841:function(e,t,a){"use strict";a.d(t,{A:function(){return T}});var o=a(9274);const l={class:"col span-12"},s={class:"row mt-20 mb-20"},r={class:"col span-6"},n={class:"col span-6"},i={class:"row"},d={key:0,class:"row mt-10 mb-20"},u={class:"row mt-20"},c={class:"col span-9"},p={key:0,class:"col span-3"};function m(e,t,a,m,v,h){const f=(0,o.resolveComponent)("LabeledSelect"),y=(0,o.resolveComponent)("RadioGroup"),g=(0,o.resolveComponent)("LabeledInput"),b=(0,o.resolveComponent)("MatchExpressions"),k=(0,o.resolveComponent)("ArrayListGrouped");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{style:{width:"100%"},class:"row","onUpdate:value":t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(k,{value:v.allSelectorTerms,"onUpdate:value":t[0]||(t[0]=e=>v.allSelectorTerms=e),class:"mt-20","default-add-value":v.defaultAddValue,mode:a.mode,"add-label":h.addLabel,onRemove:h.remove},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(f,{mode:a.mode,options:[e.t("workload.scheduling.affinity.affinityOption"),e.t("workload.scheduling.affinity.antiAffinityOption")],value:t.row.value._anti?e.t("workload.scheduling.affinity.antiAffinityOption"):e.t("workload.scheduling.affinity.affinityOption"),label:e.t("workload.scheduling.affinity.type"),"data-testid":`pod-affinity-type-index${t.i}`,"onUpdate:value":e=>t.row.value._anti=!t.row.value._anti},null,8,["mode","options","value","label","data-testid","onUpdate:value"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(f,{mode:a.mode,options:[e.t("workload.scheduling.affinity.preferred"),e.t("workload.scheduling.affinity.required")],value:h.priorityDisplay(t.row.value),label:e.t("workload.scheduling.affinity.priority"),"data-testid":`pod-affinity-priority-index${t.i}`,"onUpdate:value":e=>h.changePriority(t.row.value,t.i)},null,8,["mode","options","value","label","data-testid","onUpdate:value"])])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(y,{options:h.namespaceSelectionOptions,labels:h.namespaceSelectionLabels,name:`namespaces-${t.row.value._id}`,mode:a.mode,value:t.row.value._namespaceOption,"data-testid":`pod-affinity-namespacetype-index${t.i}`,"onUpdate:value":e=>h.changeNamespaceMode(e,t.row.value,t.i)},null,8,["options","labels","name","mode","value","data-testid","onUpdate:value"])]),t.row.value._namespaceOption===v.NAMESPACE_SELECTION_OPTION_VALUES.SELECTED?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[h.hasNamespaces&&!a.forceInputNamespaceSelection?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,value:t.row.value.namespaces,"onUpdate:value":[e=>t.row.value.namespaces=e,e=>h.updateNamespaces(t.row.value,t.row.value.namespaces)],mode:a.mode,multiple:!0,taggable:!0,options:h.allNamespacesOptions,label:h.labeledInputNamespaceLabel,"data-testid":`pod-affinity-namespace-select-index${t.i}`},null,8,["value","onUpdate:value","mode","options","label","data-testid"])):((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,value:t.row.value._namespaces,"onUpdate:value":[e=>t.row.value._namespaces=e,e=>h.updateNamespaces(t.row.value,t.row.value._namespaces)],mode:a.mode,label:h.labeledInputNamespaceLabel,placeholder:e.t("harvesterManager.affinity.namespaces.placeholder"),"data-testid":`pod-affinity-namespace-input-index${t.i}`},null,8,["value","onUpdate:value","mode","label","placeholder","data-testid"]))])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(b,{mode:a.mode,class:"col span-12 mt-20",type:h.pod,value:h.get(t.row.value,"labelSelector.matchExpressions"),"show-remove":!1,"data-testid":`pod-affinity-expressions-index${t.i}`,"onUpdate:value":e=>h.updateLabelSelector(e,t)},null,8,["mode","type","value","data-testid","onUpdate:value"]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",c,[h.hasNodes?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,value:t.row.value.topologyKey,"onUpdate:value":[e=>t.row.value.topologyKey=e,h.update],taggable:!0,searchable:!0,"close-on-select":!1,mode:a.mode,required:"",label:e.t("workload.scheduling.affinity.topologyKey.label"),placeholder:h.topologyKeyPlaceholder,options:h.existingNodeLabels,disabled:"view"===a.mode,loading:a.loading,"data-testid":`pod-affinity-topology-select-index${t.i}`},null,8,["value","onUpdate:value","mode","label","placeholder","options","disabled","loading","data-testid"])):((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,value:t.row.value.topologyKey,"onUpdate:value":[e=>t.row.value.topologyKey=e,h.update],mode:a.mode,label:e.t("workload.scheduling.affinity.topologyKey.label"),placeholder:h.topologyKeyPlaceholder,required:"","data-testid":`pod-affinity-topology-input-index${t.i}`},null,8,["value","onUpdate:value","mode","label","placeholder","data-testid"]))]),"weight"in t.row.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(g,{value:t.row.value.weight,"onUpdate:value":[e=>t.row.value.weight=e,h.update],valueModifiers:{number:!0},mode:a.mode,type:"number",min:"1",max:"100",label:e.t("workload.scheduling.affinity.weight.label"),placeholder:e.t("workload.scheduling.affinity.weight.placeholder"),"data-testid":`pod-affinity-weight-index${t.i}`},null,8,["value","onUpdate:value","mode","label","placeholder","data-testid"])])):(0,o.createCommentVNode)("",!0)])])),_:1},8,["value","default-add-value","mode","add-label","onRemove"])])],32)}var v=a(24466),h=a(71779),f=a(92590),y=a(20665),g=a(26855),b=a(77562),k=a(21221),w=a(5327),N=a(41594),E=a(73331),V=a(40833),S=a.n(V),C=a(11331),x=a(26812);const B={POD:"pod",ALL:"all",SELECTED:"selected"};var U={emits:["update"],components:{ArrayListGrouped:C.A,MatchExpressions:g.A,LabeledSelect:b.A,RadioGroup:k.z,LabeledInput:w.o},props:{value:{type:Object,default:()=>({})},field:{type:String,default:"affinity"},mode:{type:String,default:"create"},nodes:{type:Array,default:()=>[]},namespaces:{type:Array,default:null},allNamespacesOptionAvailable:{default:!1,type:Boolean},forceInputNamespaceSelection:{default:!1,type:Boolean},removeLabeledInputNamespaceLabel:{default:!1,type:Boolean},overwriteLabels:{type:Object,default:null},loading:{default:!1,type:Boolean}},data(){return{allSelectorTerms:[],defaultWeight:1,rerenderNums:(0,N.vx)(4),NAMESPACE_SELECTION_OPTION_VALUES:B,defaultAddValue:{_namespaceOption:B.POD,matchExpressions:[],namespaces:null,_namespaces:null}}},computed:{...(0,v.L8)({t:"i18n/t"}),isView(){return this.mode===h.nW},pod(){return y.Sm},node(){return y.NW},labeledInputNamespaceLabel(){return this.removeLabeledInputNamespaceLabel?"":this.overwriteLabels?.namespaceInputLabel||this.t("workload.scheduling.affinity.matchExpressions.inNamespaces")},allNamespacesOptions(){const e=this.$store.getters["currentStore"](y.CU),t=this.namespaces||this.$store.getters[`${e}/all`](y.CU),a=(0,E.Ul)(t.map((e=>({label:e.nameDisplay,value:e.id}))),"label");return a},existingNodeLabels(){return(0,x.oQ)(this.nodes)},hasNodes(){return this.nodes.length},namespaceSelectionOptions(){return this.allNamespacesOptionAvailable?[B.POD,B.ALL,B.SELECTED]:[B.POD,B.SELECTED]},namespaceSelectionLabels(){return this.overwriteLabels?.namespaceSelectionLabels?this.overwriteLabels?.namespaceSelectionLabels:this.allNamespacesOptionAvailable?[this.t("workload.scheduling.affinity.thisPodNamespace"),this.t("workload.scheduling.affinity.allNamespaces"),this.t("workload.scheduling.affinity.matchExpressions.inNamespaces")]:[this.t("workload.scheduling.affinity.thisPodNamespace"),this.t("workload.scheduling.affinity.matchExpressions.inNamespaces")]},addLabel(){return this.overwriteLabels?.addLabel||this.t("podAffinity.addLabel")},topologyKeyPlaceholder(){return this.overwriteLabels?.topologyKeyPlaceholder||this.t("workload.scheduling.affinity.topologyKey.placeholder")},hasNamespaces(){return this.allNamespacesOptions.length}},created(){this.value[this.field]||(this.value[this.field]={});const{podAffinity:e={},podAntiAffinity:t={}}=this.value[this.field],a=[...e.preferredDuringSchedulingIgnoredDuringExecution||[],...e.requiredDuringSchedulingIgnoredDuringExecution||[]].map((e=>{let t=(0,f.o8)(e);return t._id=(0,N.vx)(4),t._anti=!1,e.podAffinityTerm?(Object.assign(t,e.podAffinityTerm),t=this.parsePodAffinityTerm(t),delete t.podAffinityTerm):t=this.parsePodAffinityTerm(t),t})),o=[...t.preferredDuringSchedulingIgnoredDuringExecution||[],...t.requiredDuringSchedulingIgnoredDuringExecution||[]].map((e=>{let t=(0,f.o8)(e);return t._id=(0,N.vx)(4),t._anti=!0,e.podAffinityTerm?(Object.assign(t,e.podAffinityTerm),t=this.parsePodAffinityTerm(t),delete t.podAffinityTerm):t=this.parsePodAffinityTerm(t),t}));this.allSelectorTerms=[...a,...o],this.queueUpdate=S()(this.update,500)},methods:{parsePodAffinityTerm(e){return e.namespaceSelector&&"object"===typeof e.namespaceSelector&&!Object.keys(e.namespaceSelector).length&&this.allNamespacesOptionAvailable?e._namespaceOption=B.ALL:e.namespaces?.length?e._namespaceOption=B.SELECTED:e._namespaceOption=B.POD,e._namespaces=(e.namespaces||[]).toString(),e},update(){const e={requiredDuringSchedulingIgnoredDuringExecution:[],preferredDuringSchedulingIgnoredDuringExecution:[]},t={requiredDuringSchedulingIgnoredDuringExecution:[],preferredDuringSchedulingIgnoredDuringExecution:[]};this.allSelectorTerms.forEach((a=>{if(a._anti)if(a.weight){const e={podAffinityTerm:{...a},weight:a.weight||this.defaultWeight};delete e.podAffinityTerm.weight,t.preferredDuringSchedulingIgnoredDuringExecution.push(e)}else t.requiredDuringSchedulingIgnoredDuringExecution.push(a);else if(a.weight){const t={podAffinityTerm:a,weight:a.weight||this.defaultWeight};e.preferredDuringSchedulingIgnoredDuringExecution.push(t)}else e.requiredDuringSchedulingIgnoredDuringExecution.push(a)})),Object.assign(this.value[this.field],{podAffinity:e,podAntiAffinity:t}),this.$emit("update",this.value)},remove(){this.rerenderNums=(0,N.vx)(4),this.queueUpdate()},changePriority(e,t){e.weight?delete e.weight:e.weight=this.defaultWeight,this.allSelectorTerms[t]=(0,f.o8)(e),this.queueUpdate()},priorityDisplay(e){return"weight"in e?this.t("workload.scheduling.affinity.preferred"):this.t("workload.scheduling.affinity.required")},changeNamespaceMode(e,t,a){switch(t["_namespaceOption"]=e,e){case B.POD:t.namespaces=null,t._namespaces=null,(t.namespaceSelector||null===t.namespaceSelector)&&delete t.namespaceSelector;break;case B.ALL:t.namespaceSelector={},(t.namespaces||null===t.namespaces)&&delete t.namespaces,(t._namespaces||null===t._namespaces)&&delete t._namespaces;break;default:t["namespaces"]=[],t["_namespaces"]="",(t.namespaceSelector||null===t.namespaceSelector)&&delete t.namespaceSelector;break}this.allSelectorTerms[a]=t,this.queueUpdate()},updateNamespaces(e,t){let a=t;"string"===typeof t&&(a=t.split(",").map((e=>e.trim())).filter((e=>e?.length))),e["namespaces"]=a,this.queueUpdate()},updateLabelSelector(e,t){this.set(t.row.value,"labelSelector.matchExpressions",e),this.queueUpdate()},isEmpty:f.Im,get:f.Jt,set:f.hZ}},A=(a(76906),a(47433));const M=(0,A.A)(U,[["render",m]]);var T=M},50324:function(e,t,a){"use strict";a.d(t,{A:function(){return _}});var o=a(9274);const l={class:"mt-20"};function s(e,t,a,s,r,n){const i=(0,o.resolveComponent)("Conditions"),d=(0,o.resolveComponent)("Tab"),u=(0,o.resolveComponent)("PaginatedResourceTable"),c=(0,o.resolveComponent)("RelatedResources"),p=(0,o.resolveComponent)("Tabbed"),m=(0,o.resolveDirective)("t");return(0,o.openBlock)(),(0,o.createBlock)(p,(0,o.mergeProps)(e.$attrs,{"default-tab":a.defaultTab,onChanged:n.tabChange}),{default:(0,o.withCtx)((()=>[(0,o.renderSlot)(e.$slots,"default"),r.showConditions?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,"label-key":"resourceTabs.conditions.tab",name:"conditions",weight:-1,"display-alert-icon":n.conditionsHaveIssues},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{value:a.value},null,8,["value"])])),_:1},8,["display-alert-icon"])):(0,o.createCommentVNode)("",!0),n.showEvents?((0,o.openBlock)(),(0,o.createBlock)(d,{key:1,"label-key":"resourceTabs.events.tab",name:"events",weight:-2},{default:(0,o.withCtx)((()=>["events"===r.selectedTab?((0,o.openBlock)(),(0,o.createBlock)(u,{key:0,schema:r.eventSchema,"local-filter":n.filterEventsLocal,"api-filter":n.filterEventsApi,"use-query-params-for-simple-filtering":!1,headers:n.eventHeaders,paginationHeaders:r.paginationHeaders,namespaced:!1},null,8,["schema","local-filter","api-filter","headers","paginationHeaders"])):(0,o.createCommentVNode)("",!0)])),_:1})):(0,o.createCommentVNode)("",!0),n.showRelated?((0,o.openBlock)(),(0,o.createBlock)(d,{key:2,name:"related","label-key":"resourceTabs.related.tab",weight:-3},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("h3",null,null,512),[[m,"resourceTabs.related.from"]]),(0,o.createVNode)(c,{"ignore-types":[a.value.type],value:a.value,direction:"from"},null,8,["ignore-types","value"]),(0,o.withDirectives)((0,o.createElementVNode)("h3",l,null,512),[[m,"resourceTabs.related.to"]]),(0,o.createVNode)(c,{"ignore-types":[a.value.type],value:a.value,direction:"to"},null,8,["ignore-types","value"])])),_:1})):(0,o.createCommentVNode)("",!0)])),_:3},16,["default-tab","onChanged"])}var r=a(4335),n=a(94877),i=a(72706);function d(e,t,a,l,s,r){const n=(0,o.resolveComponent)("SortableTable");return(0,o.openBlock)(),(0,o.createBlock)(n,{headers:r.headers,rows:r.rows,"key-field":"condition","default-sort-by":"condition","table-actions":!1,"row-actions":!1,search:!1},{"cell:condition":(0,o.withCtx)((({row:e})=>[(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)({"text-error":e.error})},(0,o.toDisplayString)(e.condition),3)])),"cell:status":(0,o.withCtx)((({row:e})=>[(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)({"text-error":e.error})},(0,o.toDisplayString)(e.status),3)])),_:1},8,["headers","rows"])}var u=a(49934),c={components:{SortableTable:u.A},props:{value:{type:Object,default:()=>({})}},computed:{headers(){return[{name:"condition",labelKey:"tableHeaders.condition",value:"condition",width:150,sort:"condition",dashIfEmpty:!0},{name:"status",labelKey:"tableHeaders.status",value:"status",width:75,sort:"status",dashIfEmpty:!0},{name:"time",labelKey:"tableHeaders.updated",value:"time",sort:"time",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125,dashIfEmpty:!0},{name:"message",labelKey:"tableHeaders.message",value:"message",sort:["message"],dashIfEmpty:!0}]},rows(){return(this.value.status?.conditions||[]).map((e=>{let t=e.message||"";return e.reason&&(t=`[${e.reason}] ${t}`.trim()),{condition:e.type||"Unknown",status:e.status||"Unknown",error:e.error,time:e.lastProbeTime||e.lastUpdateTime||e.lastTransitionTime,message:t}}))}}},p=a(47433);const m=(0,p.A)(c,[["render",d]]);var v=m,h=a(20665);function f(e,t,a,l,s,r){const n=(0,o.resolveComponent)("ResourceTable");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(n,(0,o.mergeProps)(e.$attrs,{schema:e.schema,rows:e.rows,"alt-loading":e.canPaginate&&!e.isFirstLoad,loading:e.loading,groupable:e.groupable,headers:e.safeHeaders,namespaced:e.namespaced,"external-pagination-enabled":e.canPaginate,"external-pagination-result":e.paginationResult,onPaginationChanged:e.paginationChanged}),(0,o.createSlots)({_:2},[(0,o.renderList)(e.$slots,((t,a)=>({name:a,fn:(0,o.withCtx)((t=>[(0,o.renderSlot)(e.$slots,a,(0,o.normalizeProps)((0,o.guardReactiveProps)(t)))]))})))]),1040,["schema","rows","alt-loading","loading","groupable","headers","namespaced","external-pagination-enabled","external-pagination-result","onPaginationChanged"])])}var y=a(24001),g=a(60712),b=(0,o.defineComponent)({name:"PaginatedResourceTable",components:{ResourceTable:g.A},mixins:[y.A],props:{schema:{type:Object,required:!0},headers:{type:Array,default:null},paginationHeaders:{type:Array,default:null},groupable:{type:Boolean,default:null},namespaced:{type:Boolean,default:null},fetchSecondaryResources:{type:Function,default:null},fetchPageSecondaryResources:{type:Function,default:null}},data(){return{resource:this.schema.id}},async fetch(){const e=[this.$fetchType(this.resource,[],this.inStore)];this.fetchSecondaryResources&&e.push(this.fetchSecondaryResources({canPaginate:this.canPaginate})),await Promise.all(e)},computed:{safeHeaders(){const e=this.canPaginate?this.paginationHeaders:this.headers;return e||this.$store.getters["type-map/headersFor"](this.schema,this.canPaginate)}}});const k=(0,p.A)(b,[["render",f]]);var w=k,N=a(71779);function E(e,t,a,l,s,r){const n=(0,o.resolveComponent)("BadgeState"),i=(0,o.resolveComponent)("ResourceTable");return(0,o.openBlock)(),(0,o.createBlock)(i,{schema:null,rows:r.rows,headers:r.headers,search:!1,"table-actions":!1,namespaced:!0,"mangle-action-resources":r.getRealResources,"paging-label":"sortableTable.paging.generic",groupable:!1},{"cell:state":(0,o.withCtx)((({row:e})=>[e.real?((0,o.openBlock)(),(0,o.createBlock)(n,{key:0,value:e.real},null,8,["value"])):((0,o.openBlock)(),(0,o.createBlock)(n,{key:1,value:e},null,8,["value"]))])),_:1},8,["rows","headers","mangle-action-resources"])}var V=a(75798),S=a(49263),C=a(73331),x=a(25221),B=a(60018),U={components:{ResourceTable:g.A,BadgeState:B.j},props:{value:{type:Object,required:!0},rel:{type:String,default:null},direction:{type:String,default:"to"},ignoreTypes:{type:Array,default:()=>[]}},data(){return{loadedResources:1}},computed:{filteredRelationships(){let e=this.value?.metadata?.relationships||[];return e=e.filter((e=>{const t=e[`${this.direction}Type`];return!(!t||this.ignoreTypes.includes(t))&&(!this.rel||e.rel===this.rel)})),e},rows(){if(this.loadedResources<1)return;const e=this.$store.getters["clusterId"],t=this.$store.getters["currentStore"](),a=[];for(const o of this.filteredRelationships){const l=o.state||"active",s=(0,V.uU)(l,o.error,o.transitioning),r=o[`${this.direction}Type`],n=this.$store.getters[`${t}/schemaFor`](r);let i=o[`${this.direction}Id`];if(!i)continue;let d=null;const u=i.indexOf("/"),c=`${r}/${d}/${i}`;u>0&&(d=i.substr(0,u),i=i.substr(u+1));const p={name:`c-cluster-product-resource${d?"-namespace":""}-id`,params:{product:x.o,cluster:"management"===t?"local":e,resource:r,namespace:d,id:i}};a.push({type:r,real:this.$store.getters[`${t}/byId`](r,o[`${this.direction}Id`]),id:o[`${this.direction}Id`],state:l,metadata:{namespace:d,name:i},_key:c,name:i,namespace:d,nameDisplay:i,nameSort:(0,C.RY)(i).toLowerCase(),stateColor:s,detailLocation:p,typeDisplay:this.$store.getters["type-map/labelFor"](n),stateDisplay:(0,V.ch)(l),stateBackground:s.replace("text-","bg-"),groupByLabel:d})}return a},headers(){return[S.c4,S.ZE,S.o_,S.CU]}},methods:{async getRealResources(e){const t=this.$store.getters["currentStore"](),a=await Promise.allSettled(e.map((e=>this.$store.dispatch(`${t}/find`,{type:e.type,id:e.id})))),o=[];for(let l=0;l<a.length;l++)"fulfilled"===a[l].status&&o.push(a[l].value);return this.loadedResources++,o}}};const A=(0,p.A)(U,[["render",E]]);var M=A,T=a(72280),I=a(41808),L=a(39977),O={name:"ResourceTabs",components:{Tabbed:r.A,Tab:n.A,Conditions:v,PaginatedResourceTable:w,RelatedResources:M},mixins:[i.A],props:{value:{type:Object,default:()=>({})},mode:{type:String,default:N.nW},defaultTab:{type:String,default:null},needConditions:{type:Boolean,default:!0},needEvents:{type:Boolean,default:!0},needRelated:{type:Boolean,default:!0},extensionParams:{type:Object,default:null}},data(){const e=this.$store.getters["currentStore"](h.ll),t=this.$store.getters[`${e}/schemaFor`](h.ll),a=t?[I.ke,I.qI,S.rh,(0,L.UQ)("Subobject",t,this.$store.getters,!0),(0,L.UQ)("Source",t,this.$store.getters,!0),S.w5,(0,L.UQ)("First Seen",t,this.$store.getters,!0),(0,L.UQ)("Count",t,this.$store.getters,!0),I.l3]:[];return{eventSchema:t,EVENT:h.ll,selectedTab:this.defaultTab,inStore:e,showConditions:!1,paginationHeaders:a}},beforeUnmount(){this.$store.dispatch("cluster/forgetType",h.ll)},fetch(){this.setShowConditions()},computed:{showEvents(){return this.isView&&this.needEvents&&this.eventSchema},showRelated(){return this.isView&&this.needRelated},eventHeaders(){return[{name:"type",label:this.t("tableHeaders.type"),value:"eventType",sort:"eventType"},{name:"reason",label:this.t("tableHeaders.reason"),value:"reason",sort:"reason"},{name:"date",label:this.t("tableHeaders.updated"),value:"date",sort:"date:desc",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125},{name:"message",label:this.t("tableHeaders.message"),value:"message",sort:"message"}]},conditionsHaveIssues(){return!!this.showConditions&&this.value.status?.conditions?.filter((e=>!(0,V.rv)(e))).some((e=>e.error))}},methods:{tabChange(e){this.selectedTab=e?.selectedName},async setShowConditions(){this.isView&&this.needConditions&&this.value?.type&&this.schema?.fetchResourceFields&&(await this.schema.fetchResourceFields(),this.showConditions=this.$store.getters[`${this.inStore}/pathExistsInSchema`](this.value.type,"status.conditions"))},filterEventsLocal(e){return e.filter((e=>e.involvedObject?.uid===this.value?.metadata?.uid))},filterEventsApi(e){e.filters||(e.filters=[]);const t="involvedObject.uid";let a=null;for(let l=0;l<e.filters.length;l++){const o=e.filters[l];if(o.fields.find((e=>e.field===t))){a=o;break}}const o=T.eY.createSingleField({field:t,exact:!0,value:this.value.metadata.uid,equals:!0});return a?Object.assign(a,o):e.filters.push(o),e}}};const $=(0,p.A)(O,[["render",s]]);var _=$},63418:function(e,t,a){"use strict";a.d(t,{A:function(){return c}});var o=a(9274);function l(e,t,a,l,s,r){const n=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createBlock)(n,(0,o.mergeProps)({ref:"value",value:r.displayValue},e.$attrs,{type:"number",min:a.min,mode:a.mode,label:a.label,delay:a.delay,"label-key":a.labelKey,tooltip:a.tooltip,"tooltip-key":a.tooltipKey,required:a.required,placeholder:a.placeholder,"hide-arrows":a.hideArrows,"onUpdate:value":r.update,onBlur:t[0]||(t[0]=e=>r.update(e.target.value))}),{suffix:(0,o.withCtx)((()=>[r.displayUnit?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,class:(0,o.normalizeClass)(["addon",{"with-tooltip":a.tooltip||a.tooltipKey}])},(0,o.toDisplayString)(r.displayUnit),3)):(0,o.createCommentVNode)("",!0)])),_:1},16,["value","min","mode","label","delay","label-key","tooltip","tooltip-key","required","placeholder","hide-arrows","onUpdate:value"])}var s=a(49844),r=a(5327),n=a(71779),i={components:{LabeledInput:r.o},emits:["update:value","update:validation","change","blur"],props:{outputAs:{type:String,default:"number"},outputModifier:{type:Boolean,default:!1},inputExponent:{type:Number,default:0},baseUnit:{type:String,default:"B"},hideArrows:{type:Boolean,default:!1},increment:{type:Number,default:1e3},suffix:{type:String,default:null},mode:{type:String,default:n.G5},value:{type:[Number,String],default:null},label:{type:String,default:null},labelKey:{type:String,default:null},tooltip:{type:[String,Object],default:null},tooltipKey:{type:String,default:null},required:{type:Boolean,default:!1},min:{type:[Number,String],default:0},placeholder:{type:[String,Number],default:""},delay:{type:Number,default:0},positive:{type:Boolean,default:!1}},computed:{unit(){let e;return e=this.inputExponent>=0?s.QN[this.inputExponent]:s.kq[-1*this.inputExponent],1024===this.increment&&e&&(e+="i"),e},parsedValue(){return"string"===typeof this.value?(0,s.ao)(this.value):this.value},displayValue(){let e="";return(this.parsedValue||0===this.parsedValue)&&(e=(0,s.Mo)(this.parsedValue,{increment:this.increment,addSuffix:!1,maxExponent:this.inputExponent,minExponent:this.inputExponent})),e},displayUnit(){return this.suffix?this.suffix:this.unit+this.baseUnit}},methods:{focus(){const e=this.$refs.value;e&&e.focus()},update(e){let t=""===e?null:e;this.positive&&e<0&&(t=0),this.outputModifier?t=null===t?null:`${parseInt(e)}${this.unit}`:"string"===this.outputAs?t=null===t?"":`${e}`:t&&(t=this.unit?(0,s.ao)(`${t}${this.unit}`):parseInt(t)),this.$emit("update:value",t)}}},d=(a(62869),a(47433));const u=(0,d.A)(i,[["render",l],["__scopeId","data-v-3c2f5c19"]]);var c=u},27547:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C},ksmtunedMode:function(){return w},ksmtunedRunOption:function(){return N}});var o=a(9274);const l={class:"row"},s={class:"col span-6"},r={class:"col span-6"},n={class:"row"},i={class:"col span-6"},d={class:"col span-6"},u={class:"row"},c={class:"col span-6"};function p(e,t,a,p,m,v){const h=(0,o.resolveComponent)("LabeledSelect"),f=(0,o.resolveComponent)("UnitInput"),y=(0,o.resolveComponent)("Checkbox"),g=(0,o.resolveComponent)("t"),b=(0,o.resolveComponent)("RadioGroup"),k=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(h,{value:m.spec.run,"onUpdate:value":t[0]||(t[0]=e=>m.spec.run=e),label:e.t("harvester.host.ksmtuned.run"),options:m.ksmtunedRunOption,class:"mb-20",mode:a.mode,required:""},null,8,["value","label","options","mode"]),v.showKsmt?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(f,{value:m.spec.thresCoef,"onUpdate:value":t[1]||(t[1]=e=>m.spec.thresCoef=e),valueModifiers:{number:!0},label:e.t("harvester.host.ksmtuned.thresCoef"),suffix:"%",delay:0,required:"",mode:a.mode,class:"mb-20"},null,8,["value","label","mode"]),(0,o.createVNode)(y,{value:m.enableMergeAcrossNodes,"onUpdate:value":t[2]||(t[2]=e=>m.enableMergeAcrossNodes=e),mode:a.mode,class:"check mb-20",type:"checkbox",label:e.t("harvester.host.ksmtuned.enableMergeNodes")},null,8,["value","mode","label"]),(0,o.createElementVNode)("h3",null,[(0,o.createVNode)(g,{k:"harvester.host.ksmtuned.modeLink",raw:!0,url:v.ksmtunedLink},null,8,["url"])]),(0,o.createVNode)(b,{value:m.spec.mode,"onUpdate:value":t[3]||(t[3]=e=>m.spec.mode=e),class:"mb-20",name:e.t("harvester.host.ksmtuned.mode"),options:m.ksmtunedMode},null,8,["value","name","options"]),v.isCustomizedMode?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(k,{value:m.spec.ksmtunedParameters.boost,"onUpdate:value":t[4]||(t[4]=e=>m.spec.ksmtunedParameters.boost=e),valueModifiers:{number:!0},required:"",type:"number",label:e.t("harvester.host.ksmtuned.parameters.boost"),tooltip:e.t("harvester.host.ksmtuned.parameters.description.boost"),class:"mb-20",mode:a.mode},null,8,["value","label","tooltip","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(k,{value:m.spec.ksmtunedParameters.decay,"onUpdate:value":t[5]||(t[5]=e=>m.spec.ksmtunedParameters.decay=e),valueModifiers:{number:!0},required:"",type:"number",label:e.t("harvester.host.ksmtuned.parameters.decay"),tooltip:e.t("harvester.host.ksmtuned.parameters.description.decay"),class:"mb-20",mode:a.mode},null,8,["value","label","tooltip","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(k,{value:m.spec.ksmtunedParameters.minPages,"onUpdate:value":t[6]||(t[6]=e=>m.spec.ksmtunedParameters.minPages=e),valueModifiers:{number:!0},required:"",type:"number",label:e.t("harvester.host.ksmtuned.parameters.minPages"),tooltip:e.t("harvester.host.ksmtuned.parameters.description.minPages"),class:"mb-20",mode:a.mode},null,8,["value","label","tooltip","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(k,{value:m.spec.ksmtunedParameters.maxPages,"onUpdate:value":t[7]||(t[7]=e=>m.spec.ksmtunedParameters.maxPages=e),valueModifiers:{number:!0},required:"",type:"number",label:e.t("harvester.host.ksmtuned.parameters.maxPages"),tooltip:e.t("harvester.host.ksmtuned.parameters.description.maxPages"),class:"mb-20",mode:a.mode},null,8,["value","label","tooltip","mode"])])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(k,{value:m.spec.ksmtunedParameters.sleepMsec,"onUpdate:value":t[8]||(t[8]=e=>m.spec.ksmtunedParameters.sleepMsec=e),valueModifiers:{number:!0},required:"",type:"number",label:e.t("harvester.host.ksmtuned.parameters.sleepMsec"),tooltip:e.t("harvester.host.ksmtuned.parameters.description.sleepMsec"),class:"mb-20",mode:a.mode},null,8,["value","label","tooltip","mode"])])])],64)):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0)])}var m=a(77562),v=a(5327),h=a(63418),f=a(21221),y=a(34211),g=a(32766),b=a(66242),k=a(3791);const w=[{value:"standard",label:"Standard"},{value:"high",label:"High-Perfomanace"},{value:"customized",label:"Customized"}],N=[{label:"Run",value:"run"},{label:"Stop",value:"stop"},{label:"Prune",value:"prune"}];var E={name:"HarvesterKsmtuned",components:{Checkbox:y.S,LabeledInput:v.o,LabeledSelect:m.A,RadioGroup:f.z,UnitInput:h.A},props:{mode:{type:String,required:!0},node:{type:Object,required:!0},registerBeforeHook:{type:Function,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t=await this.$store.dispatch(`${e}/findAll`,{type:g.rk.KSTUNED});this.ksmtuned=t.find((e=>e.id===this.node.id)),this.enableMergeAcrossNodes=!!this.ksmtuned.spec?.mergeAcrossNodes,this.spec=this.ksmtuned.spec},data(){return{ksmtuned:{},spec:{},thresCoef:30,ksmtunedMode:w,ksmtunedRunOption:N,enableMergeAcrossNodes:!0}},created(){this.registerBeforeHook(this.saveKsmtuned,"saveKsmtuned")},computed:{isCustomizedMode(){return"customized"===this.spec.mode},showKsmt(){return"run"===this.spec.run},ksmtunedLink(){const e=this.$store.getters["harvester-common/getServerVersion"]();return(0,k.nn)(b.d.KSMTUNED_MODE,e)}},methods:{async saveKsmtuned(){this.spec.mergeAcrossNodes=this.enableMergeAcrossNodes?1:0,this.ksmtuned["spec"]=this.spec,await this.ksmtuned.save().catch((e=>{if("error"===e?.type)return this.$store.dispatch("growl/error",{title:this.t("harvester.notification.title.error"),message:e?.message},{root:!0}),Promise.reject(new Error("saveKsmtuned error"))}))}}},V=a(47433);const S=(0,V.A)(E,[["render",p]]);var C=S},58094:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);const l={class:"vm__credentials-users"};function s(e,t,a,s,r,n){const i=(0,o.resolveComponent)("LabeledSelect"),d=(0,o.resolveComponent)("LabeledInput"),u=(0,o.resolveComponent)("ModalWithCard");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createVNode)(i,{value:r.selectedUser,"onUpdate:value":t[0]||(t[0]=e=>r.selectedUser=e),options:a.userOptions,label:e.t("harvester.virtualMachine.accessCredentials.injectSSH.users"),taggable:a.multiple,mode:a.mode,multiple:a.multiple,searchable:!1,tooltip:e.t("harvester.virtualMachine.accessCredentials.userTips"),class:(0,o.normalizeClass)({hasUsers:r.selectedUser.length>0}),onInput:n.update},null,8,["value","options","label","taggable","mode","multiple","tooltip","class","onInput"]),r.isOpen?((0,o.openBlock)(),(0,o.createBlock)(u,{key:0,name:r.randomStr,width:"40%",errors:r.errors,onFinish:n.addUser,onClose:n.cancel},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.virtualMachine.accessCredentials.injectSSH.addUser")),1)])),content:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{value:r.newUsername,"onUpdate:value":t[1]||(t[1]=e=>r.newUsername=e),label:e.t("harvester.virtualMachine.input.username"),class:"mb-20",required:"",onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","label","onKeydown"])])),_:1},8,["name","errors","onFinish","onClose"])):(0,o.createCommentVNode)("",!0)])}var r=a(65359),n=a(92590),i=a(41594),d=a(5327),u=a(77562),c=a(74197);const p="_NEW";var m={emits:["update:user","update:newUser"],components:{LabeledInput:d.o,LabeledSelect:u.A,ModalWithCard:c.A},props:{value:{type:[Array,String],default:()=>[]},resourceType:{type:Object,default:()=>({})},userOptions:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},mode:{type:String,default:"create"},disabled:{type:Boolean,default:!1}},data(){return{selectedUser:this.value,newUsername:"",randomStr:(0,i.vx)(5).toLowerCase(),errors:[],isOpen:!1}},computed:{...(0,r.L8)({t:"i18n/t"})},watch:{value(e){this.selectedUser=e},selectedUser(e,t){e.includes(p)&&(this["selectedUser"]=t,this.update(),this.show())}},methods:{update(){this.$emit("update:user",(0,n.o8)(this.selectedUser))},addUser(e){const t=/^[-._0-9a-zA-Z]+$/;if(this.errors=[],!t.test(this.newUsername)){const t=this.t("harvester.virtualMachine.accessCredentials.invalidUser");return this.errors.push(t),void e(!1)}if(this.userOptions.includes(this.newUsername)){const t=this.t("harvester.virtualMachine.accessCredentials.duplicatedUser");return this.errors.push(t),void e(!1)}this.multiple?this.selectedUser.push(this.newUsername):this.selectedUser=this.newUsername,this.$emit("update:newUser",this.newUsername),this.update(),e(!0),this.cancel()},show(){this.isOpen=!0},hide(){this.isOpen=!1},cancel(){this.hide(),this.newUsername=""}}},v=(a(84388),a(47433));const h=(0,v.A)(m,[["render",s]]);var f=h},60068:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var o=a(9274);const l=["onClick"],s={key:0,class:"mt-20"};function r(e,t,a,r,n,i){const d=(0,o.resolveComponent)("Banner"),u=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(d,{class:"mb-20",color:"info",label:e.t("harvester.virtualMachine.accessCredentials.tips")},null,8,["label"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.rows,((e,s)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:s},[(0,o.createVNode)(u,{class:"volume-source"},{default:(0,o.withCtx)((()=>[i.isEdit?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"role-link btn btn-sm remove-vol",onClick:t=>i.remove(e)},t[2]||(t[2]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,l)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("h3",null,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(i.headerFor(e.source)),1)]),(0,o.createElementVNode)("div",null,[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(i.componentFor(e.source)),{value:n.rows[s],"onUpdate:value":e=>n.rows[s]=e,rows:n.rows,"resource-type":a.resourceType,"user-options":i.userOptions,mode:a.mode,idx:s,onUpdate:i.update,"onUpdate:newUser":i.updateNewUser},null,40,["value","onUpdate:value","rows","resource-type","user-options","mode","idx","onUpdate","onUpdate:newUser"]))])])),_:2},1024)])))),128)),i.isEdit&&a.isQemuInstalled?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm bg-primary mr-15 mb-10",onClick:t[0]||(t[0]=e=>i.addCredentials(n.ACCESS_CREDENTIALS.RESET_PWD))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.accessCredentials.resetPwd.label")),1),(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm bg-primary mr-15 mb-10",onClick:t[1]||(t[1]=e=>i.addCredentials(n.ACCESS_CREDENTIALS.INJECT_SSH))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.accessCredentials.injectSSH.label")),1)])):(0,o.createCommentVNode)("",!0)])}var n=a(65359),i=a(89121),d=a(58536),u=a(41594),c=a(26812),p=a(71779),m=a(2602),v=a(66905);const h="_NEW";var f={emits:["update:value"],components:{Banner:i.l,InfoBox:d.A},props:{value:{type:Array,default:()=>[]},resourceType:{type:Object,default:()=>({})},mode:{type:String,default:"create"},disableCreate:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isQemuInstalled:{type:Boolean,default:!1}},data(){return{ACCESS_CREDENTIALS:v.cI,toRemove:[],toSave:[],rows:[],newUserOptions:[]}},computed:{...(0,n.L8)({t:"i18n/t"}),isEdit(){return this.mode===p.G5},historyUsersOptions(){const e=JSON.parse(this.resourceType?.spec?.template?.metadata?.annotations?.[m.r.DYNAMIC_SSHKEYS_USERS]||"[]");return e.unshift({label:this.t("harvester.virtualMachine.accessCredentials.injectSSH.addUser"),value:h}),e},userOptions(){return Array.from(new Set([...this.historyUsersOptions,...this.newUserOptions]))}},watch:{value:{handler(e){this.rows=[...e]},deep:!0,immediate:!0}},methods:{addCredentials(e){const t={source:e,users:[],sshkeys:[],username:"",newPassword:"",secretName:this.generateSecretName(this.resourceType.metadata.name)};this.rows.push(t),this.update()},remove(e){(0,c.Gj)(this.rows,e),this.update()},update(){this.$emit("update:value",this.rows)},updateNewUser(e){this.newUserOptions.push(e)},generateSecretName(e){return e?`${e}-${(0,u.vx)(5).toLowerCase()}`:void 0},componentFor(e){switch(e){case v.cI.RESET_PWD:return a(23574)["default"];case v.cI.INJECT_SSH:return a(18933)["default"]}},headerFor(e){return{userPassword:this.$store.getters["i18n/t"]("harvester.virtualMachine.accessCredentials.resetPwd.label"),sshPublicKey:this.$store.getters["i18n/t"]("harvester.virtualMachine.accessCredentials.injectSSH.label")}[e]}}},y=(a(38239),a(47433));const g=(0,y.A)(f,[["render",r],["__scopeId","data-v-61977bc4"]]);var b=g},23574:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const l={class:"col span-6"},s={class:"col span-6"};function r(e,t,a,r,n,i){const d=(0,o.resolveComponent)("AccessCredentialsUsers"),u=(0,o.resolveComponent)("Password");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"row","onUpdate:value":t[2]||(t[2]=(...e)=>i.update&&i.update(...e))},[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:a.value.username,"onUpdate:value":t[0]||(t[0]=e=>a.value.username=e),"resource-type":a.resourceType,"user-options":a.userOptions,multiple:!1,mode:a.mode,"onUpdate:user":i.updateUser,"onUpdate:newUser":i.updateNewUser},null,8,["value","resource-type","user-options","mode","onUpdate:user","onUpdate:newUser"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(u,{ref:"password",value:a.value.newPassword,"onUpdate:value":t[1]||(t[1]=e=>a.value.newPassword=e),mode:a.mode,disabled:"edit"!==a.mode,label:e.t("harvester.virtualMachine.input.password"),required:""},null,8,["value","mode","disabled","label"])])],32)}var n=a(66888),i=a(58094),d={name:"HarvesterEditVolume",emits:["update","update:newUser"],components:{Password:n.A,AccessCredentialsUsers:i["default"]},props:{mode:{type:String,default:"create"},resourceType:{type:Object,default:()=>({})},userOptions:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})}},data(){return{defaultPwdValue:{username:"",newPassword:""}}},methods:{update(){this.$emit("update")},updateUser(e){this.value["username"]=e,this.update()},updateNewUser(e){this.$emit("update:newUser",e)}}},u=(a(27461),a(47433));const c=(0,u.A)(d,[["render",r],["__scopeId","data-v-7d19b7bd"]]);var p=c},18933:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=a(9274);const l={class:"columns row"},s={class:"col span-6"},r={class:"col span-6"};function n(e,t,a,n,i,d){const u=(0,o.resolveComponent)("AccessCredentialsUsers"),c=(0,o.resolveComponent)("SSHKey");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(u,{value:a.value.users,"onUpdate:value":t[0]||(t[0]=e=>a.value.users=e),"resource-type":a.resourceType,"user-options":a.userOptions,mode:a.mode,multiple:!0,"onUpdate:user":d.updateUser,"onUpdate:newUser":d.updateNewUser},null,8,["value","resource-type","user-options","mode","onUpdate:user","onUpdate:newUser"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:a.value.sshkeys,"onUpdate:value":t[1]||(t[1]=e=>a.value.sshkeys=e),class:"mb-20",namespace:a.resourceType.metadata.namespace,mode:a.mode,searchable:!1,"onUpdate:sshKey":d.updateSSH},null,8,["value","namespace","mode","onUpdate:sshKey"])])])])}var i=a(59026),d=a(58094),u={name:"HarvesterEditVolume",emits:["update","update:newUser"],components:{SSHKey:i["default"],AccessCredentialsUsers:d["default"]},props:{mode:{type:String,default:"create"},resourceType:{type:Object,default:()=>({})},userOptions:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})}},methods:{update(){this.$emit("update")},updateUser(e){this.value["users"]=e,this.update()},updateSSH(e){this.value["sshkeys"]=e,this.update()},updateNewUser(e){this.$emit("update:newUser",e)}}},c=a(47433);const p=(0,c.A)(u,[["render",n]]);var m=p},16369:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var o=a(9274);const l={class:"mb-20"},s={class:"text-muted mb-20"},r={class:"resource-yaml"};function n(e,t,a,n,i,d){const u=(0,o.resolveComponent)("t"),c=(0,o.resolveComponent)("LabeledSelect"),p=(0,o.resolveComponent)("YamlEditor");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t(`harvester.virtualMachine.cloudConfig.${a.type}.title`)),1),(0,o.createElementVNode)("p",s,[(0,o.createVNode)(u,{k:`harvester.virtualMachine.cloudConfig.${a.type}.tip`,raw:!0},null,8,["k"])]),d.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,value:i.id,"onUpdate:value":t[0]||(t[0]=e=>i.id=e),class:"mb-20",options:a.options,disabled:a.viewCode,"label-key":`harvester.virtualMachine.cloudConfig.${a.type}.label`},null,8,["value","options","disabled","label-key"])),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(p,{ref:"yaml",value:i.yamlScript,"onUpdate:value":t[1]||(t[1]=e=>i.yamlScript=e),class:"yaml-editor","editor-mode":d.editorMode},null,8,["value","editor-mode"])])])}var i=a(65359),d=a(77562),u=a(36316),c=a(71779),p=a(20665);const m="_NEW",v="_NONE";var h={components:{YamlEditor:u.A,LabeledSelect:d.A},emits:["updateTemplateId","show","update"],props:{mode:{type:String,default:"create"},value:{type:String,default:""},type:{type:String,default:""},options:{type:Array,default:()=>[]},configId:{type:String,default:""},viewCode:{type:Boolean,default:!1}},data(){return{id:"",yamlScript:this.value}},computed:{...(0,i.L8)({t:"i18n/t"}),editorMode(){return this.isView||this.viewCode?u.j.VIEW_CODE:u.j.EDIT_CODE},isView(){return this.mode===c.nW}},watch:{value(e){this.yamlScript=e},configId(e){this.id=this.configId},id(e,t){const a=this.$store.getters["harvester/byId"](p.K5,e)?.data?.cloudInit||"";if(this.$emit("updateTemplateId",this.type,e),e){if(e===m)return this.$emit("show",this.type),void(this.id=t);this.yamlScript=e===v?"":a,this.$refs["yaml"].updateValue(a)}},yamlScript(e){this.$emit("update",e,this.type)}},methods:{refresh(){this.$refs.yaml.refresh()},updateValue(){this.$refs["yaml"].updateValue(this.value)}}},f=(a(71157),a(47433));const y=(0,f.A)(h,[["render",n],["__scopeId","data-v-1613a356"]]);var g=y},81559:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var o=a(9274);const l={key:0},s={class:"mb-20"},r={class:"mb-20"},n={class:"yaml"},i={class:"resource-yaml"};function d(e,t,a,d,u,c){const p=(0,o.resolveComponent)("DataTemplate"),m=(0,o.resolveComponent)("LabeledInput"),v=(0,o.resolveComponent)("YamlEditor"),h=(0,o.resolveComponent)("ModalWithCard");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[c.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("h2",l,(0,o.toDisplayString)(e.t("harvester.virtualMachine.cloudConfig.title")),1)),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(p,{ref:"userTemplate",value:a.userScript,type:"user","view-code":a.viewCode,mode:a.mode,"config-id":u.configUserId,options:u.optionUser,onShow:c.show,onUpdate:c.update,onUpdateTemplateId:c.updateTemplateId},null,8,["value","view-code","mode","config-id","options","onShow","onUpdate","onUpdateTemplateId"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(p,{ref:"networkTemplate",value:a.networkScript,type:"network","view-code":a.viewCode,mode:a.mode,"config-id":u.configNetworkId,options:u.optionNetwork,onShow:c.show,onUpdate:c.update},null,8,["value","view-code","mode","config-id","options","onShow","onUpdate"])]),u.isOpen?((0,o.openBlock)(),(0,o.createBlock)(h,{key:1,name:"createCloudTemplate",width:"40%",errors:u.errors,onFinish:c.save,onClose:c.cancel},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.virtualMachine.cloudConfig.createTemplateTitle",{name:c.createTypeLable})),1)])),content:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{value:u.cloudTemplateName,"onUpdate:value":t[0]||(t[0]=e=>u.cloudTemplateName=e),label:e.t("harvester.virtualMachine.input.name"),class:"mb-20",required:"",onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","label","onKeydown"]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{ref:"createTemplate",value:u.cloudTemplate,"onUpdate:value":t[1]||(t[1]=e=>u.cloudTemplate=e),class:"yaml-editor","editor-mode":c.editorMode},null,8,["value","editor-mode"])])])])),_:1},8,["errors","onFinish","onClose"])):(0,o.createCommentVNode)("",!0)])}var u=a(65359),c=a(5327),p=a(36316),m=a(74197),v=a(20665),h=a(2602),f=a(71779),y=a(16369);const g="_NEW";var b={emits:["updateUserData","updateNetworkData","updateDataTemplateId"],components:{DataTemplate:y["default"],YamlEditor:p.A,LabeledInput:c.o,ModalWithCard:m.A},props:{mode:{type:String,default:"create"},namespace:{type:String,default:""},userScript:{type:String,default:""},networkScript:{type:String,default:""},viewCode:{type:Boolean,default:!1}},data(){return{errors:[],templateType:"",cloudTemplate:"",cloudTemplateName:"",configUserId:"",configNetworkId:"",optionUser:[],optionNetwork:[],isOpen:!1}},async fetch(){const e=await this.$store.dispatch("harvester/findAll",{type:v.K5}),t=[],a=[];for(const o of e)"user"===o.metadata?.labels?.[h.r.CLOUD_INIT]&&t.push({label:o?.id,value:o?.id}),"network"===o.metadata?.labels?.[h.r.CLOUD_INIT]&&a.push({label:o?.id,value:o?.id});t.unshift({label:this.t("harvester.virtualMachine.cloudConfig.createNew"),value:g}),a.unshift({label:this.t("harvester.virtualMachine.cloudConfig.createNew"),value:g}),this.optionUser=t,this.optionNetwork=a},computed:{...(0,u.L8)({t:"i18n/t"}),createTypeLable(){const e=`harvester.virtualMachine.cloudConfig.${this.templateType}.label`;return this.t(e)},editorMode(){return this.isView?p.j.VIEW_CODE:p.j.EDIT_CODE},isView(){return this.mode===f.nW}},methods:{updateValue(){this.$refs["userTemplate"].updateValue(),this.$refs["networkTemplate"].updateValue()},update(e,t){"user"===t&&this.$emit("updateUserData",e),"network"===t&&this.$emit("updateNetworkData",e)},updateTemplateId(e,t){this.$emit("updateDataTemplateId",e,t)},show(e){this.templateType=e,this.isOpen=!0},async save(e){if(this.errors=[],!this.cloudTemplateName)return this.errors.push(this.t("validation.required",{key:this.t("harvester.virtualMachine.input.name")},!0)),void e(!1);if(!this.cloudTemplate){const t="user"===this.templateType?"harvester.cloudTemplate.userData":"harvester.cloudTemplate.networkData";return this.errors.push(this.t("validation.required",{key:this.t(t)},!0)),void e(!1)}const t=await this.$store.dispatch("harvester/create",{type:v.K5,metadata:{labels:{[h.r.CLOUD_INIT]:this.templateType},name:this.cloudTemplateName,namespace:this.namespace},data:{cloudInit:this.cloudTemplate}});try{const a=await t.save();a.id&&("user"===this.templateType?this.configUserId=a.id:this.configNetworkId=a.id,this.$fetch()),e(!0),this.cancel()}catch(a){this.errors=[a.message],e(!1)}},cancel(){this.cloudTemplate="",this.cloudTemplateName="",this["errors"]=[],this.isOpen=!1},refresh(){this.$refs["userTemplate"].refresh(),this.$refs["networkTemplate"].refresh()}}},k=(a(9729),a(47433));const w=(0,k.A)(b,[["render",d],["__scopeId","data-v-2d3a6d84"]]);var N=w},46324:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var o=a(9274);const l={class:"row"},s={class:"col span-6 mb-10"},r={class:"col span-6 mb-10"};function n(e,t,a,n,i,d){const u=(0,o.resolveComponent)("UnitInput"),c=(0,o.resolveComponent)("InputOrDisplay");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(c,{name:"CPU",value:d.cupDisplay,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{value:i.localCpu,"onUpdate:value":[t[0]||(t[0]=e=>i.localCpu=e),d.change],label:"CPU",suffix:"C",delay:0,required:"",disabled:a.disabled,mode:a.mode,class:"mb-20"},null,8,["value","disabled","mode","onUpdate:value"])])),_:1},8,["value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{name:e.t("harvester.virtualMachine.input.memory"),value:d.memoryDisplay,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{value:i.localMemory,"onUpdate:value":[t[1]||(t[1]=e=>i.localMemory=e),d.change],label:e.t("harvester.virtualMachine.input.memory"),mode:a.mode,"input-exponent":3,delay:0,increment:1024,"output-modifier":!0,disabled:a.disabled,required:"",suffix:i.GIBIBYTE,class:"mb-20"},null,8,["value","label","mode","disabled","suffix","onUpdate:value"])])),_:1},8,["name","value","mode"])])])}var i=a(63418),d=a(78090),u=a(84757),c={name:"HarvesterEditCpuMemory",emits:["updateCpuMemory"],components:{UnitInput:i.A,InputOrDisplay:d.A},props:{cpu:{type:Number,default:null},memory:{type:String,default:null},mode:{type:String,default:"create"},disabled:{type:Boolean,default:!1}},data(){return{GIBIBYTE:u.Wl,localCpu:this.cpu,localMemory:this.memory}},computed:{cupDisplay(){return`${this.localCpu} C`},memoryDisplay(){return`${this.localMemory}`}},watch:{cpu(e){this.localCpu=e},memory(e){e&&!e.includes("null")&&(this.localMemory=e)}},methods:{change(){let e="";e=String(this.localMemory).includes("Gi")?this.localMemory:`${this.localMemory}${u.Wl}`,e.includes("null")&&(e=null),this.$emit("updateCpuMemory",this.localCpu,e)}}},p=a(47433);const m=(0,p.A)(c,[["render",n]]);var v=m},48893:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(9274);const l={class:"row mb-20"},s={"data-testid":"input-hen-name",class:"col span-6"},r={"data-testid":"input-hen-model",class:"col span-6"},n={"data-testid":"input-hen-networkName",class:"col span-6"},i={"data-testid":"input-hen-type",class:"col span-6"},d={key:0},u={class:"row mb-20"},c={class:"row"},p={key:0,"data-testid":"input-hen-macAddress",class:"col span-6"};function m(e,t,a,m,v,h){const f=(0,o.resolveComponent)("LabeledInput"),y=(0,o.resolveComponent)("InputOrDisplay"),g=(0,o.resolveComponent)("LabeledSelect");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(y,{name:e.t("harvester.fields.name"),value:a.value.name,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{value:a.value.name,"onUpdate:value":[t[0]||(t[0]=e=>a.value.name=e),h.update],label:e.t("harvester.fields.name"),required:"",mode:a.mode,disabled:h.isDisabled},null,8,["value","label","mode","disabled","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(y,{name:e.t("harvester.fields.model"),value:a.value.model,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{value:a.value.model,"onUpdate:value":[t[1]||(t[1]=e=>a.value.model=e),h.update],label:e.t("harvester.fields.model"),disabled:h.isDisabled,options:h.modelOption,mode:a.mode,required:""},null,8,["value","label","disabled","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["row",{"mb-20":!v.isMasquerade}])},[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(y,{name:e.t("harvester.fields.network"),value:a.value.networkName,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{value:a.value.networkName,"onUpdate:value":[t[2]||(t[2]=e=>a.value.networkName=e),h.updateNetworkName],label:e.t("harvester.fields.network"),options:h.allNetworkOption,mode:a.mode,required:"",disabled:h.isDisabled},null,8,["value","label","options","mode","disabled","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(y,{name:e.t("harvester.fields.type"),value:a.value.type,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{value:a.value.type,"onUpdate:value":[t[3]||(t[3]=e=>a.value.type=e),h.update],label:e.t("harvester.fields.type"),options:h.typeOption,mode:a.mode,required:""},null,8,["value","label","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])],2),!v.isMasquerade&&a.isSingle?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("a",{role:"button",onClick:t[4]||(t[4]=(...e)=>h.toggleAdvanced&&h.toggleAdvanced(...e))},(0,o.toDisplayString)(v.showAdvanced?e.t("harvester.generic.hideMore"):e.t("harvester.generic.showMore")),1)]),(0,o.createElementVNode)("div",c,[v.showAdvanced?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(y,{name:e.t("harvester.fields.macAddress"),value:a.value.macAddress,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{value:a.value.macAddress,"onUpdate:value":[t[5]||(t[5]=e=>a.value.macAddress=e),h.update],"label-key":"harvester.fields.macAddress",mode:a.mode,tooltip:e.t("harvester.virtualMachine.volume.macTip")},null,8,["value","mode","tooltip","onUpdate:value"])])),_:1},8,["name","value","mode"])])):(0,o.createCommentVNode)("",!0)])])):(0,o.createCommentVNode)("",!0)])}var v=a(78090),h=a(5327),f=a(77562),y=a(92590),g=a(71779),b=a(48249);const k=[{label:"virtio",value:"virtio"},{label:"e1000",value:"e1000"},{label:"e1000e",value:"e1000e"},{label:"ne2k_pci",value:"ne2k_pci"},{label:"pcnet",value:"pcnet"},{label:"rtl8139",value:"rtl8139"}];var w={name:"HarvesterEditNetwork",emits:["update"],components:{LabeledInput:h.o,LabeledSelect:f.A,InputOrDisplay:v.A},props:{value:{type:Object,default:()=>({})},networkOption:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},mode:{type:String,default:"create"},isSingle:{type:Boolean,default:!0}},data(){const e=this.value.isPod;return e&&(this.value.networkName=b.PO),{isMasquerade:e,hasManagementNetwork:!1,showAdvanced:!1}},computed:{isDisabled(){return this.isMasquerade&&!this.value.newCreateId&&!this.isCreate},isView(){return this.mode===g.nW},isCreate(){return this.mode===g.YQ},modelOption(){return k},allNetworkOption(){const e=(0,y.o8)(this.networkOption),t=[{label:b.PO,value:b.PO}];return this.value.newCreateId&&this.hasManagementNetwork?e:this.value.newCreateId&&!this.hasManagementNetwork?[...t,...e]:this.isMasquerade?t:e},typeOption(){const e=[{label:"masquerade",value:"masquerade"},{label:"bridge",value:"bridge"}],t=[{label:"bridge",value:"bridge"}];return this.isMasquerade?e:t}},watch:{rows:{handler(e){const t=!!e.some((e=>e.isPod));this["hasManagementNetwork"]=t},immediate:!0,deep:!0},isSingle(e){e||(this.value["macAddress"]="",this.update())}},methods:{updateNetworkName(e){e===b.PO?(this.value.isPod=!0,this.value.macAddress=""):this.value.isPod=!1,this["isMasquerade"]=this.value.isPod,this.value.isPod?this.value.type="masquerade":this.value.type="bridge",this.update()},update(){this.$emit("update")},toggleAdvanced(){this.showAdvanced=!this.showAdvanced}}},N=a(47433);const E=(0,N.A)(w,[["render",m]]);var V=E},8746:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var o=a(9274);const l=["onClick"];function s(e,t,a,s,r,n){const i=(0,o.resolveComponent)("Base"),d=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(r.rows,((s,u)=>((0,o.openBlock)(),(0,o.createBlock)(d,{key:u},{default:(0,o.withCtx)((()=>[n.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"role-link remove-vol",onClick:e=>n.remove(s)},t[1]||(t[1]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,l)),(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("harvester.virtualMachine.network.title")),1),(0,o.createVNode)(i,{value:r.rows[u],"onUpdate:value":e=>r.rows[u]=e,rows:r.rows,mode:a.mode,"is-single":a.isSingle,"network-option":n.networkOption,onUpdate:n.update},null,8,["value","onUpdate:value","rows","mode","is-single","network-option","onUpdate"])])),_:2},1024)))),128)),n.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn btn-sm bg-primary",onClick:t[0]||(t[0]=(...e)=>n.add&&n.add(...e))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.network.addNetwork")),1))])}var r=a(58536),n=a(20665),i=a(73331),d=a(92590),u=a(41594),c=a(26812),p=a(71779),m=a(2602),v=a(48893),h={components:{InfoBox:r.A,Base:v["default"]},props:{mode:{type:String,default:"create"},value:{type:Array,default:()=>[]},isSingle:{type:Boolean,default:!0}},data(){return{rows:this.addKeyId((0,d.o8)(this.value)),nameIdx:1}},computed:{isView(){return this.mode===p.nW},networkOption(){const e=this.$store.getters["harvester/all"](n.XG).filter((e=>!e.metadata?.annotations?.[m.r.STORAGE_NETWORK])),t=(0,i.Ul)(e.map((e=>{const t=e.isNotReady?`${e.id} (${this.t("generic.notReady")})`:e.id;return{label:t,value:e.id,disabled:e.isNotReady}})),"label");return t}},watch:{value(e){this.rows=e}},methods:{add(e){const t=this.generateName(),a={name:t,networkName:"",model:"virtio",type:"bridge",newCreateId:(0,u.vx)(10),rowKeyId:(0,u.vx)(10)};this.rows.push(a),this.update()},remove(e){(0,c.Gj)(this.rows,e),this.update()},addKeyId(e){return e.map((e=>({...e,rowKeyId:(0,u.vx)(10)})))},generateName(){let e="",t=!0;while(t)e=`nic-${this.nameIdx}`,t=this.rows.find((t=>t.name===e)),this.nameIdx++;return e},update(){this.$emit("update:value",this.rows)}}},f=(a(89982),a(47433));const y=(0,f.A)(h,[["render",s],["__scopeId","data-v-697c87ca"]]);var g=y},59026:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var o=a(9274);function l(e,t,a,l,s,r){const n=(0,o.resolveComponent)("LabeledSelect"),i=(0,o.resolveComponent)("LabeledInput"),d=(0,o.resolveComponent)("ModalWithCard");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(n,{value:s.checkedSsh,"onUpdate:value":[t[0]||(t[0]=e=>s.checkedSsh=e),r.update],label:e.t("harvester.virtualMachine.input.sshKey"),taggable:!a.disabled,mode:a.mode,multiple:!0,searchable:a.searchable,disabled:a.disabled,options:r.sshOption},null,8,["value","label","taggable","mode","searchable","disabled","options","onUpdate:value"]),s.isOpen?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,name:s.randomStr,width:"40%",errors:s.errors,onFinish:r.save,onClose:r.cancel},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.virtualMachine.sshTitle")),1)])),content:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{value:s.sshName,"onUpdate:value":t[1]||(t[1]=e=>s.sshName=e),label:e.t("harvester.virtualMachine.input.name"),class:"mb-20",required:"",onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","label","onKeydown"]),(0,o.createVNode)(i,{value:s.publicKey,"onUpdate:value":t[2]||(t[2]=e=>s.publicKey=e),label:e.t("harvester.virtualMachine.input.sshKeyValue"),"min-height":160,class:"mb-20",type:"multiline",required:""},null,8,["value","label"])])),_:1},8,["name","errors","onFinish","onClose"])):(0,o.createCommentVNode)("",!0)])}var s=a(65359),r=a(41594),n=a(5327),i=a(77562),d=a(74197),u=a(71779),c=a(20665),p=a(32766);const m="_NEW";var v={emits:["update:sshKey"],components:{LabeledInput:n.o,ModalWithCard:d.A,LabeledSelect:i.A},props:{value:{type:Array,default:()=>[]},mode:{type:String,default:"create"},disableCreate:{type:Boolean,default:!1},namespace:{type:String,default:""},createNamespace:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},data(){return{checkedSsh:this.value,publicKey:"",sshName:"",randomStr:(0,r.vx)(5).toLowerCase(),errors:[],isAll:!1,checkAll:!1,isOpen:!1}},computed:{...(0,s.L8)({t:"i18n/t"}),schema(){return this.$store.getters["harvester/schemaFor"](p.rk.SSH)},isCreatable(){return!(this.schema&&!this.schema?.collectionMethods.find((e=>["blocked-post","post"].includes(e.toLowerCase()))))},sshOption(){if(this.mode===u.nW||this.mode===u.G5)return[];const e=this.$store.getters["harvester/all"](p.rk.SSH).map((e=>({label:e.id,value:e.id})));return!this.disableCreate&&this.mode!==u.nW&&this.isCreatable&&e.unshift({label:this.t("harvester.virtualMachine.createSSHKey"),value:m}),e}},watch:{publicKey(e){const t=e.trim(),a=t.split(/\s+/);if(3===a.length&&!this.sshName){const e=a[2];this.randomStr=(0,r.vx)(10).toLowerCase(),this.sshName=e.includes("@")?e.split("@")[0]:e}},value(e){this.checkedSsh=e},checkedSsh(e){e.includes(m)&&this.show()}},methods:{show(){this.isOpen=!0},hide(){this.isOpen=!1},async createNamespaceIfNeeded(){if(!this.createNamespace||this.disableCreate)return;const e=await this.$store.dispatch("harvester/findAll",{type:c.CU}),t=e?.find((e=>e.name===this.namespace));if(!t){const e=await this.$store.dispatch("harvester/createNamespace",{name:this.namespace},{root:!0});e.applyDefaults(),await e.save()}},async createSSHKey(){const e=await this.$store.dispatch("harvester/create",{metadata:{name:this.sshName,namespace:this.namespace},spec:{publicKey:this.publicKey},type:p.rk.SSH}),t=await e.save();t.id&&(this.checkedSsh.push(`${this.namespace}/${this.sshName}`),this.update())},async save(e){if(this.errors=[],!this.sshName){const e=this.t("harvester.virtualMachine.input.name"),t=this.t("validation.required",{key:e});this.errors.push(t)}if(!this.publicKey){const e=this.t("harvester.virtualMachine.input.sshKeyValue"),t=this.t("validation.required",{key:e});this.errors.push(t)}if(this.sshName.length>63){const e=this.t("harvester.validation.custom.tooLongName",{max:63});this.errors.push(e)}if(this.errors.length>0)e(!1);else try{await this.createNamespaceIfNeeded(),await this.createSSHKey(),e(!0),this.cancel()}catch(t){this.errors=[t.message],e(!1)}},cancel(){this.hide(),this.resetFields()},resetFields(){this.sshName="",this.publicKey="",this.errors=[]},update(){const e=this.checkedSsh.filter((e=>e!==m));this.$emit("update:sshKey",e)}}},h=a(47433);const f=(0,h.A)(v,[["render",l]]);var y=f},24830:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return q}});var o=a(9274);const l=["onClick"],s=["onClick"],r={key:0,class:"title"},n=["href"],i={key:1},d={class:"bootOrder"},u={key:0,class:"mr-15"},c=["disabled","onClick"],p=["disabled","onClick"],m={class:"text-muted"},v={class:"mt-15"},h={key:2},f=["disabled"],y={class:"buttons"};function g(e,t,a,g,b,k){const w=(0,o.resolveComponent)("Banner"),N=(0,o.resolveComponent)("router-link"),E=(0,o.resolveComponent)("BadgeStateFormatter"),V=(0,o.resolveComponent)("InfoBox"),S=(0,o.resolveComponent)("VueDraggableNext"),C=(0,o.resolveComponent)("ModalWithCard"),x=(0,o.resolveDirective)("clean-tooltip");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[k.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(w,{key:0,color:"info","label-key":"harvester.virtualMachine.volume.dragTip"})),(0,o.createVNode)(S,{list:b.rows,disabled:k.isView,"item-key":"id",onEnd:k.update},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(b.rows,((h,f)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:h.id},[(0,o.createVNode)(V,{class:"box"},{default:(0,o.withCtx)((()=>[k.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"role-link btn btn-sm remove",onClick:e=>k.removeVolume(h)},t[6]||(t[6]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,l)),h.hotpluggable&&k.isView?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"role-link btn remove",onClick:e=>k.unplugVolume(h)},(0,o.toDisplayString)(e.t("harvester.virtualMachine.unplug.detachVolume")),9,s)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("h3",null,[h.to&&k.isVirtualType?((0,o.openBlock)(),(0,o.createElementBlock)("span",r,[(0,o.createVNode)(N,{to:h.to},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.edit"))+" "+(0,o.toDisplayString)(k.headerFor(h.source)),1)])),_:2},1032,["to"]),h.pvc?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,class:"ml-10 state",arbitrary:!0,row:h.pvc,value:h.pvc.state},null,8,["row","value"])):(0,o.createCommentVNode)("",!0),k.dev&&h.pvc&&h.pvc.resourceExternalLink?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,class:"ml-5 resource-external",rel:"nofollow noopener noreferrer",target:"_blank",href:h.pvc.resourceExternalLink.url},t[7]||(t[7]=[(0,o.createElementVNode)("i",{class:"icon icon-external-link"},null,-1)]),8,n)),[[x,e.t(h.pvc.resourceExternalLink.tipsKey||"generic.resourceExternalLinkTips")]]):(0,o.createCommentVNode)("",!0)])):((0,o.openBlock)(),(0,o.createElementBlock)("span",i,(0,o.toDisplayString)(k.headerFor(h.source,!!h?.volumeBackups)),1))]),(0,o.createElementVNode)("div",null,[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(k.componentFor(h.source)),{value:b.rows[f],rows:b.rows,namespace:a.namespace,"is-create":k.isCreate,"is-edit":k.isEdit,"is-view":k.isView,"is-virtual-type":k.isVirtualType,mode:a.mode,idx:f,"validate-required":a.validateRequired,onUpdate:k.update},null,40,["value","rows","namespace","is-create","is-edit","is-view","is-virtual-type","mode","idx","validate-required","onUpdate"]))]),(0,o.createElementVNode)("div",d,[k.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",u,[(0,o.createElementVNode)("button",{disabled:0===f,class:"btn btn-sm role-primary",onClick:(0,o.withModifiers)((e=>k.changeSort(f,!1)),["prevent"])},t[8]||(t[8]=[(0,o.createElementVNode)("i",{class:"icon icon-lg icon-chevron-up"},null,-1)]),8,c),(0,o.createElementVNode)("button",{disabled:f===b.rows.length-1,class:"btn btn-sm role-primary",onClick:(0,o.withModifiers)((e=>k.changeSort(f,!0)),["prevent"])},t[9]||(t[9]=[(0,o.createElementVNode)("i",{class:"icon icon-lg icon-chevron-down"},null,-1)]),8,p)])),(0,o.createElementVNode)("div",m," bootOrder: "+(0,o.toDisplayString)(f+1),1)]),(0,o.createElementVNode)("div",v,[h.volumeStatus&&!k.isCreate?((0,o.openBlock)(),(0,o.createBlock)(w,{key:0,class:"volume-status",color:"warning",label:b.ucFirst(h.volumeStatus)},null,8,["label"])):(0,o.createCommentVNode)("",!0),a.value.volumeBackups&&a.value.volumeBackups.error&&a.value.volumeBackups.error.message?((0,o.openBlock)(),(0,o.createBlock)(w,{key:1,color:"error",label:b.ucFirst(a.value.volumeBackups.error.message)},null,8,["label"])):(0,o.createCommentVNode)("",!0),k.isLonghornV2(h)&&!k.isView?((0,o.openBlock)(),(0,o.createBlock)(w,{key:2,color:"warning",label:e.t("harvester.volume.longhorn.disableResize")},null,8,["label"])):(0,o.createCommentVNode)("",!0)])])),_:2},1024)])))),128))])),_:1},8,["list","disabled","onEnd"]),k.showVolumeTip?((0,o.openBlock)(),(0,o.createBlock)(w,{key:1,color:"warning",label:e.t("harvester.virtualMachine.volume.volumeTip")},null,8,["label"])):(0,o.createCommentVNode)("",!0),k.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm bg-primary mr-15 mb-10",disabled:0===b.rows.length,onClick:t[0]||(t[0]=e=>k.addVolume(b.SOURCE_TYPE.NEW))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.addVolume")),9,f),a.existingVolumeDisabled?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn btn-sm bg-primary mr-15 mb-10",onClick:t[1]||(t[1]=e=>k.addVolume(b.SOURCE_TYPE.ATTACH_VOLUME))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.addExistingVolume")),1)),(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm bg-primary mr-15 mb-10",onClick:t[2]||(t[2]=e=>k.addVolume(b.SOURCE_TYPE.IMAGE))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.addVmImage")),1),(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm bg-primary mb-10",onClick:t[3]||(t[3]=e=>k.addVolume(b.SOURCE_TYPE.CONTAINER))},(0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.addContainer")),1)])),b.isOpen?((0,o.openBlock)(),(0,o.createBlock)(C,{key:3,name:"deleteTip",width:400},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.unmount.title")),1)])),content:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.t("harvester.virtualMachine.volume.unmount.message")),1)])),footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("button",{class:"btn role-secondary mr-20",onClick:t[4]||(t[4]=(0,o.withModifiers)(((...e)=>k.cancel&&k.cancel(...e)),["prevent"]))},(0,o.toDisplayString)(e.t("generic.no")),1),(0,o.createElementVNode)("button",{class:"btn bg-primary mr-20",onClick:t[5]||(t[5]=(0,o.withModifiers)(((...e)=>k.deleteVolume&&k.deleteVolume(...e)),["prevent"]))},(0,o.toDisplayString)(e.t("generic.yes")),1)])])),_:1})):(0,o.createCommentVNode)("",!0)])}var b=a(98285),k=a(58536),w=a(89121),N=a(67976),E=a(63418),V=a(5327),S=a(77562),C=a(74197),x=a(20665),B=a(92590),U=a(41594),A=a(26812),M=a(71779),T=a(85401),I=a(66905),L=a(20652),O=a(32766),$=a(41837),_={emits:["update:value"],components:{Banner:w.l,BadgeStateFormatter:N.A,VueDraggableNext:b.H,InfoBox:k.A,LabeledInput:V.o,UnitInput:E.A,LabeledSelect:S.A,ModalWithCard:C.A},props:{vm:{type:Object,default:()=>({})},mode:{type:String,default:M.YQ},value:{type:Array,default:()=>[]},namespace:{type:String,default:null},existingVolumeDisabled:{type:Boolean,default:!1},validateRequired:{type:Boolean,default:!1},customVolumeMode:{type:String,default:$.vU.Block},customAccessMode:{type:String,default:"ReadWriteMany"},resourceType:{type:String,default:""}},async fetch(){await this.$store.dispatch("harvester/findAll",{type:x.YH})},data(){return{ucFirst:U.TF,SOURCE_TYPE:I.xO,rows:(0,B.o8)(this.value),nameIdx:1,vol:null,isOpen:!1}},computed:{dev(){try{return this.$store.getters["prefs/get"](T.bc)}catch{return this.$store.getters["prefs/get"](T.IJ)}},isVirtualType(){return this.resourceType===O.rk.VM},isView(){return this.mode===M.nW},isEdit(){return this.mode===M.G5},isCreate(){return this.mode===M.YQ},defaultStorageClass(){const e=this.$store.getters["harvester/all"](x.fJ).find((e=>e.isDefault));return e},showVolumeTip(){const e=this.getImageDisplayName(this.rows[0]?.image);return!(1!==this.rows.length||"cd-rom"!==this.rows[0].type||!/.iso$/i.test(e))},pvcs(){return this.$store.getters["harvester/all"](x.YH)||[]}},watch:{value:{handler(e){const t=(0,B.o8)(e).map((e=>(this.isCreate||e.source===I.xO.CONTAINER||e.newCreateId||(e.to={name:`${L.KR}-c-cluster-resource-namespace-id`,params:{resource:O.rk.VOLUME,namespace:this.namespace,id:e.realName},query:{mode:M.G5}},e.pvc=this.pvcs.find((t=>t.metadata.name===e.realName))),e)));this["rows"]=t},deep:!0,immediate:!0}},methods:{addVolume(e){const t=this.generateName(),a={id:(0,U.vx)(5),name:t,source:e,size:"10Gi",type:"disk",accessMode:this.customAccessMode,volumeMode:this.customVolumeMode,volumeName:"",bus:"virtio",newCreateId:(0,U.vx)(10)};e===I.xO.NEW&&(a.storageClassName=this.defaultStorageClass?.metadata?.name||"longhorn"),this.rows.push(a),this.update()},generateName(){let e="",t=!0;while(t)e=`disk-${this.nameIdx}`,t=this.rows.find((t=>t.name===e)),this.nameIdx++;return e},removeVolume(e){this.vol=e,!e.newCreateId&&this.isEdit&&this.isVirtualType?this.isOpen=!0:((0,A.Gj)(this.rows,e),this.update())},unplugVolume(e){this.vm.unplugVolume(e.name)},componentFor(e){switch(e){case I.xO.NEW:return a(46173)["default"];case I.xO.IMAGE:return a(88021)["default"];case I.xO.ATTACH_VOLUME:return a(71189)["default"];case I.xO.CONTAINER:return a(88656)["default"]}},headerFor(e,t=!1){const a={[I.xO.NEW]:this.$store.getters["i18n/t"]("harvester.virtualMachine.volume.title.volume"),[I.xO.IMAGE]:this.$store.getters["i18n/t"]("harvester.virtualMachine.volume.title.vmImage"),[I.xO.ATTACH_VOLUME]:this.$store.getters["i18n/t"]("harvester.virtualMachine.volume.title.existingVolume"),[I.xO.CONTAINER]:this.$store.getters["i18n/t"]("harvester.virtualMachine.volume.title.container")}[e];return t?`${a} and Backups`:a},update(){this.$emit("update:value",this.rows)},deleteVolume(){(0,A.Gj)(this.rows,this.vol),this.update(),this.cancel()},cancel(){this.isOpen=!1},changeSort(e,t){this.rows.splice(t?e:e-1,1,...this.rows.splice(t?e+1:e,1,this.rows[t?e:e-1])),this.update()},getImageDisplayName(e){return this.$store.getters["harvester/all"](O.rk.IMAGE).find((t=>t.id===e))?.spec?.displayName},isLonghornV2(e){return e?.pvc?.isLonghornV2||e?.pvc?.storageClass?.isLonghornV2}}},D=(a(82583),a(47433));const P=(0,D.A)(_,[["render",g],["__scopeId","data-v-494be023"]]);var q=P},88656:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var o=a(9274);const l={class:"row mb-20"},s={"data-testid":"input-hec-name",class:"col span-6"},r={"data-testid":"input-hec-type",class:"col span-6"},n={class:"row mb-20"},i={"data-testid":"input-hec-container",class:"col span-6"},d={"data-testid":"input-hec-bus",class:"col span-6"},u={class:"row mb-20"},c={key:0,class:"col span-6"};function p(e,t,a,p,m,v){const h=(0,o.resolveComponent)("LabeledInput"),f=(0,o.resolveComponent)("InputOrDisplay"),y=(0,o.resolveComponent)("LabeledSelect"),g=(0,o.resolveComponent)("LabelValue"),b=(0,o.resolveComponent)("Banner");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(f,{name:e.t("harvester.fields.name"),value:a.value.name,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{value:a.value.name,"onUpdate:value":[t[0]||(t[0]=e=>a.value.name=e),v.update],label:e.t("harvester.fields.name"),required:"",mode:a.mode},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(f,{name:e.t("harvester.fields.type"),value:a.value.type,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{value:a.value.type,"onUpdate:value":[t[1]||(t[1]=e=>a.value.type=e),v.update],label:e.t("harvester.fields.type"),options:m.VOLUME_TYPE,mode:a.mode,required:""},null,8,["value","label","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(f,{name:e.t("harvester.virtualMachine.volume.dockerImage"),value:a.value.container,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{value:a.value.container,"onUpdate:value":[t[2]||(t[2]=e=>a.value.container=e),v.update],label:e.t("harvester.virtualMachine.volume.dockerImage"),mode:a.mode,required:""},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(f,{name:e.t("harvester.virtualMachine.volume.bus"),value:a.value.bus,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{value:a.value.bus,"onUpdate:value":[t[3]||(t[3]=e=>a.value.bus=e),v.update],label:e.t("harvester.virtualMachine.volume.bus"),options:m.InterfaceOption,mode:a.mode},null,8,["value","label","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",u,[a.value.volumeBackups?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createVNode)(f,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:a.value.volumeBackups.readyToUse,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:a.value.volumeBackups.readyToUse},null,8,["name","value"])])),_:1},8,["name","value","mode"])])):(0,o.createCommentVNode)("",!0)]),a.value.volumeBackups&&a.value.volumeBackups.error&&a.value.volumeBackups.error.message?((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,color:"error",class:"mb-20",label:a.value.volumeBackups.error.message},null,8,["label"])):(0,o.createCommentVNode)("",!0)])}var m=a(5327),v=a(77562),h=a(78090),f=a(66905),y=a(89121),g={name:"HarvesterEditContainer",emits:["update"],components:{LabeledInput:m.o,LabeledSelect:v.A,InputOrDisplay:h.A,Banner:y.l},props:{mode:{type:String,default:"create"},value:{type:Object,required:!0}},data(){return{VOLUME_TYPE:f._w,InterfaceOption:f.$z}},watch:{"value.type"(e){"cd-rom"===e&&(this.value["bus"]="sata",this.update())}},methods:{update(){this.$emit("update")}}},b=a(47433);const k=(0,b.A)(g,[["render",p]]);var w=k},71189:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var o=a(9274);const l={class:"row mb-20"},s={"data-testid":"input-hee-name",class:"col span-6"},r={"data-testid":"input-hee-type",class:"col span-6"},n={class:"row mb-20"},i={"data-testid":"input-hee-volumeName",class:"col span-6"},d={"data-testid":"input-hee-size",class:"col span-6"},u={class:"row mb-20"},c={key:0,"data-testid":"input-hee-image",class:"col span-6"},p={"data-testid":"input-hee-bus",class:"col span-6"},m={key:1,class:"col span-6"};function v(e,t,a,v,h,f){const y=(0,o.resolveComponent)("LabeledInput"),g=(0,o.resolveComponent)("InputOrDisplay"),b=(0,o.resolveComponent)("LabeledSelect"),k=(0,o.resolveComponent)("UnitInput"),w=(0,o.resolveComponent)("LabelValue"),N=(0,o.resolveComponent)("Banner");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(g,{name:e.t("harvester.fields.name"),value:a.value.name,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{value:a.value.name,"onUpdate:value":[t[0]||(t[0]=e=>a.value.name=e),f.update],label:e.t("harvester.fields.name"),mode:a.mode,required:""},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(g,{name:e.t("harvester.fields.type"),value:a.value.type,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{value:a.value.type,"onUpdate:value":[t[1]||(t[1]=e=>a.value.type=e),f.update],label:e.t("harvester.fields.type"),mode:a.mode,options:h.VOLUME_TYPE,required:""},null,8,["value","label","mode","options","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(g,{name:e.t("harvester.fields.volume"),value:a.value.volumeName,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{value:a.value.volumeName,"onUpdate:value":[t[2]||(t[2]=e=>a.value.volumeName=e),f.update],disabled:f.isDisabled,label:e.t("harvester.fields.volume"),mode:a.mode,options:f.volumeOption,required:""},null,8,["value","disabled","label","mode","options","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(g,{name:e.t("harvester.fields.size"),value:a.value.size,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.size,"onUpdate:value":[t[3]||(t[3]=e=>a.value.size=e),f.update],"output-modifier":!0,increment:1024,"input-exponent":3,label:e.t("harvester.fields.size"),mode:a.mode,disabled:!0,suffix:h.GIBIBYTE},null,8,["value","label","mode","suffix","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",u,[f.image?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createVNode)(g,{name:e.t("harvester.fields.image"),value:f.image,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{value:f.image,"onUpdate:value":[t[4]||(t[4]=e=>f.image=e),f.update],label:e.t("harvester.fields.image"),mode:a.mode,disabled:!0},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(g,{name:e.t("harvester.virtualMachine.volume.bus"),value:a.value.bus,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{value:a.value.bus,"onUpdate:value":[t[5]||(t[5]=e=>a.value.bus=e),f.update],label:e.t("harvester.virtualMachine.volume.bus"),mode:a.mode,options:h.InterfaceOption,disabled:!0,required:""},null,8,["value","label","mode","options","onUpdate:value"])])),_:1},8,["name","value","mode"])]),a.value.volumeBackups?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createVNode)(g,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:a.value.volumeBackups.readyToUse,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:a.value.volumeBackups.readyToUse},null,8,["name","value"])])),_:1},8,["name","value","mode"])])):(0,o.createCommentVNode)("",!0)]),a.value.volumeBackups&&a.value.volumeBackups.error&&a.value.volumeBackups.error.message?((0,o.openBlock)(),(0,o.createBlock)(N,{key:0,color:"error",class:"mb-20",label:a.value.volumeBackups.error.message},null,8,["label"])):(0,o.createCommentVNode)("",!0)])}var h=a(63418),f=a(5327),y=a(92552),g=a(77562),b=a(78090),k=a(89121),w=a(73331),N=a(20665),E=a(71779),V=a(2602),S=a(32766),C=a(66905),x=a(84757),B={name:"HarvesterEditExisting",emits:["update"],components:{UnitInput:h.A,LabeledInput:f.o,LabeledSelect:g.A,InputOrDisplay:b.A,LabelValue:y.A,Banner:k.l},props:{mode:{type:String,default:E.YQ},value:{type:Object,required:!0},isEdit:{type:Boolean,default:!1},namespace:{type:String,default:null},idx:{type:Number,default:0},rows:{type:Array,required:!0}},data(){return this.value.realName&&(this.value.volumeName=this.value.realName),{GIBIBYTE:x.Wl,VOLUME_TYPE:C._w,InterfaceOption:C.$z,loading:!1}},computed:{isDisabled(){return!this.value.newCreateId&&this.isEdit},allPVCs(){const e=this.$store.getters["harvester/all"](N.YH);return e.filter((e=>!this.namespace||this.namespace===e.metadata.namespace))||[]},image(){const e=this.$store.getters["harvester/all"](S.rk.IMAGE).find((e=>e.id===this.pvcResource?.metadata?.annotations?.[V.r.IMAGE_ID]));if(e)return`${e.metadata.namespace}/${e.spec.displayName}`},pvcResource(){return this.allPVCs.find((e=>e.metadata.name===this.value.volumeName))},volumeOption(){return(0,w.Ul)(this.allPVCs.filter((e=>{let t=!0,a=!1;return this.rows.forEach((a=>{a.volumeName===e.metadata.name&&(t=!1)})),!(0===this.idx&&!e.metadata?.annotations?.[V.r.IMAGE_ID])&&("true"!==e.metadata?.annotations?.[V.r.GOLDEN_IMAGE]&&(e.attachVM&&t&&e.attachVM?.id===this.vm?.id&&this.isEdit?a=!1:e.attachVM&&(a=!0),t&&!a&&e.isAvailable))})).map((e=>({label:e.metadata.name,value:e.metadata.name}))),"label")}},watch:{"value.volumeName"(e){const t=this.allPVCs.find((t=>t.metadata.name===e));t&&(this.value.accessModes=t.spec.accessModes[0],this.value.size=t.spec.resources.requests.storage,this.value.storageClassName=t.spec.storageClassName,this.value.volumeMode=t.spec.volumeMode)},"value.type"(e){"cd-rom"===e&&(this.value["bus"]="sata",this.update())},pvcResource:{handler(e){!this.value.volumeName&&e?.metadata?.name&&(this.value.volumeName=e.metadata.name)},deep:!0,immediate:!0}},methods:{update(){this.$emit("update")}}},U=a(47433);const A=(0,U.A)(B,[["render",v]]);var M=A},88021:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return I}});var o=a(9274);const l={class:"row mb-20"},s={"data-testid":"input-hevi-name",class:"col span-6"},r={"data-testid":"input-hevi-type",class:"col span-6"},n={class:"row mb-20"},i={"data-testid":"input-hevi-image",class:"col span-6"},d={"data-testid":"input-hevi-size",class:"col span-6"},u={class:"row mb-20"},c={"data-testid":"input-hevi-bus",class:"col span-6"},p={key:0,class:"col span-3"},m={class:"row mb-20"},v={key:0,class:"col span-3"};function h(e,t,a,h,f,y){const g=(0,o.resolveComponent)("LabeledInput"),b=(0,o.resolveComponent)("InputOrDisplay"),k=(0,o.resolveComponent)("LabeledSelect"),w=(0,o.resolveComponent)("UnitInput"),N=(0,o.resolveComponent)("LabelValue"),E=(0,o.resolveComponent)("Banner");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(b,{name:e.t("harvester.fields.name"),value:a.value.name,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{value:a.value.name,"onUpdate:value":[t[0]||(t[0]=e=>a.value.name=e),y.update],label:e.t("harvester.fields.name"),required:"",mode:a.mode},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(b,{name:e.t("harvester.fields.type"),value:a.value.type,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.type,"onUpdate:value":[t[1]||(t[1]=e=>a.value.type=e),y.update],label:e.t("harvester.fields.type"),options:f.VOLUME_TYPE,mode:a.mode},null,8,["value","label","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(b,{name:e.t("harvester.fields.image"),value:y.imageName,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.image,"onUpdate:value":[t[2]||(t[2]=e=>a.value.image=e),y.onImageChange],disabled:0===a.idx&&!a.isCreate&&!a.value.newCreateId&&a.isVirtualType,label:e.t("harvester.fields.image"),options:y.imagesOption,mode:a.mode,searchable:!0,required:a.validateRequired},null,8,["value","disabled","label","options","mode","required","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(b,{name:e.t("harvester.fields.size"),value:a.value.size,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{value:a.value.size,"onUpdate:value":[t[3]||(t[3]=e=>a.value.size=e),y.update],"output-modifier":!0,increment:1024,"input-exponent":3,label:e.t("harvester.fields.size"),mode:a.mode,required:a.validateRequired,disable:y.isLonghornV2,suffix:f.GIBIBYTE},null,8,["value","label","mode","required","disable","suffix","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(b,{name:e.t("harvester.virtualMachine.volume.bus"),value:a.value.bus,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.bus,"onUpdate:value":[t[4]||(t[4]=e=>a.value.bus=e),y.update],label:e.t("harvester.virtualMachine.volume.bus"),mode:a.mode,options:f.InterfaceOption},null,8,["value","label","mode","options","onUpdate:value"])])),_:1},8,["name","value","mode"])]),a.value.volumeEncryptionFeatureEnabled&&y.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(N,{name:e.t("harvester.virtualMachine.volume.encryption"),value:y.encryptionValue},null,8,["name","value"])])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("div",m,[a.value.volumeBackups&&y.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createVNode)(N,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:y.readyToUse},null,8,["name","value"])])):(0,o.createCommentVNode)("",!0)]),a.value.volumeBackups&&a.value.volumeBackups.error&&a.value.volumeBackups.error.message?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,color:"error",class:"mb-20",label:a.value.volumeBackups.error.message},null,8,["label"])):(0,o.createCommentVNode)("",!0),!y.isView&&y.showDiskTooSmallError?((0,o.openBlock)(),(0,o.createBlock)(E,{key:1,color:"error",label:e.t("harvester.virtualMachine.volume.vmImageVolumeTip",{diskSize:y.diskSize,imageVirtualSize:y.imageVirtualSize})},null,8,["label"])):(0,o.createCommentVNode)("",!0)])}var f=a(26812),y=a(63418),g=a(5327),b=a(77562),k=a(78090),w=a(89121),N=a(20665),E=a(49844),V=a(32766),S=a(66905),C=a(71779),x=a(92552),B=a(41594),U=a(84757),A={name:"HarvesterEditVMImage",emits:["update"],components:{UnitInput:y.A,LabeledInput:g.o,LabeledSelect:b.A,InputOrDisplay:k.A,LabelValue:x.A,Banner:w.l},props:{value:{type:Object,default:()=>({})},namespace:{type:String,default:null},mode:{type:String,default:"create"},idx:{type:Number,required:!0},isCreate:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!1},validateRequired:{type:Boolean,required:!0},isVirtualType:{type:Boolean,default:!0}},data(){return{GIBIBYTE:U.Wl,VOLUME_TYPE:S._w,InterfaceOption:S.$z,loading:!1,images:[]}},fetch(){this.images=this.$store.getters["harvester/all"](V.rk.IMAGE)},computed:{encryptionValue(){return(0,B.TF)(String(this.value.isEncrypted))},isView(){return this.mode===C.nW},imagesOption(){return this.images.filter((e=>e.isReady)).sort(((e,t)=>e.creationTimestamp>t.creationTimestamp?-1:1)).map((e=>({label:this.imageOptionLabel(e),value:e.id})))},imageName(){const e=this.imagesOption.find((e=>e.value===this.value.image));return e?e.label:"-"},readyToUse(){const e=String(this.value.volumeBackups?.readyToUse||!1);return(0,B.TF)(e)},pvcsResource(){const e=this.$store.getters["harvester/all"](N.YH)||[];return e.find((e=>!this.namespace||e.id===`${this.namespace}/${this.value.volumeName}`))},thirdPartyStorageEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("thirdPartyStorage")},isLonghornV2(){return this.value.pvc?.isLonghornV2||this.value.pvc?.storageClass?.isLonghornV2},selectedImage(){return this.$store.getters["harvester/all"](V.rk.IMAGE)?.find((e=>this.value.image===e.id))},imageVirtualSize(){return this.selectedImage?.virtualSize?this.selectedImage.virtualSize.replace(" ",""):"0"},diskSize(){const e=this.value?.size||"0";return e},imageVirtualSizeInByte(){return Math.max(this.selectedImage?.status?.size,this.selectedImage?.status?.virtualSize)},diskSizeInByte(){return(0,E.ao)(this.value?.size||"0")},showDiskTooSmallError(){return!!this.thirdPartyStorageEnabled&&this.imageVirtualSizeInByte>this.diskSizeInByte}},watch:{"value.type"(e){"cd-rom"===e&&(this.value["bus"]="sata",this.update())},"value.image"(e){this.checkImageExists(e)},imagesOption(){this.checkImageExists(this.value.image)},pvcsResource:{handler(e){if(e?.spec?.resources?.requests?.storage&&this.isVirtualType){const t=(0,E.ao)(e.spec.resources.requests.storage),a=(0,E.Mo)(t,{increment:1024,addSuffix:!1,maxExponent:3,minExponent:3});this.value.size=`${a}${U.Wl}`}},deep:!0,immediate:!0}},methods:{imageOptionLabel(e){let t=`${e.metadata.namespace}/${e.spec.displayName}`;return this.thirdPartyStorageEnabled&&(t+=` (${e.imageStorageClass} / ${e.virtualSize})`),t},update(){this.value.hasDiskError=this.showDiskTooSmallError,this.$emit("update")},onImageChange(){const e=this.$store.getters["harvester/all"](V.rk.IMAGE)?.find((e=>this.value.image===e.id)),t=/iso$/i.test(e?.imageSuffix),a=Math.max(e?.status?.size,e?.status?.virtualSize);if(t?(this.value["type"]="cd-rom",this.value["bus"]="sata"):(this.value["type"]="disk",this.value["bus"]="virtio"),a){let e=Math.ceil(a/1024/1024/1024);t||(e=Math.max(e,10)),this.value["size"]=`${e}${U.Wl}`}this.update()},onOpen(){this.images=this.$store.getters["harvester/all"](V.rk.IMAGE)},checkImageExists(e){e&&this.imagesOption.length>0&&!(0,f.jq)(this.imagesOption,"value",e)&&(this.$store.dispatch("growl/error",{title:this.$store.getters["i18n/t"]("harvester.vmTemplate.tips.notExistImage.title",{name:e}),message:this.$store.getters["i18n/t"]("harvester.vmTemplate.tips.notExistImage.message")},{root:!0}),this.value["image"]="")}}},M=a(47433);const T=(0,M.A)(A,[["render",h]]);var I=T},46173:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var o=a(9274);const l={class:"row mb-20"},s={class:"col span-6","data-testid":"input-hev-name"},r={class:"col span-6","data-testid":"input-hev-type"},n={class:"row mb-20"},i={"data-testid":"input-hav-storage",class:"col span-6"},d={class:"col span-6","data-testid":"input-hev-size"},u={class:"row mb-20"},c={"data-testid":"input-hev-bus",class:"col span-6"},p={key:0,"data-testid":"input-volume-mode",class:"col span-6"},m={class:"row mb-20"},v={key:0,class:"col span-6"},h={key:1,class:"col span-6"};function f(e,t,a,f,y,g){const b=(0,o.resolveComponent)("Loading"),k=(0,o.resolveComponent)("LabeledInput"),w=(0,o.resolveComponent)("InputOrDisplay"),N=(0,o.resolveComponent)("LabeledSelect"),E=(0,o.resolveComponent)("UnitInput"),V=(0,o.resolveComponent)("LabelValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(b,{mode:"relative",loading:y.loading},null,8,["loading"]),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(w,{name:e.t("harvester.fields.name"),value:a.value.name,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.name,"onUpdate:value":[t[0]||(t[0]=e=>a.value.name=e),g.update],label:e.t("harvester.fields.name"),mode:a.mode,required:""},null,8,["value","label","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(w,{name:e.t("harvester.fields.type"),value:a.value.type,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{value:a.value.type,"onUpdate:value":[t[1]||(t[1]=e=>a.value.type=e),g.update],label:e.t("harvester.fields.type"),options:y.VOLUME_TYPE,required:"",mode:a.mode},null,8,["value","label","options","mode","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(w,{name:e.t("harvester.storage.storageClass.label"),value:a.value.storageClassName,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{value:a.value.storageClassName,"onUpdate:value":[t[2]||(t[2]=e=>a.value.storageClassName=e),g.update],options:g.storageClassOptions,label:e.t("harvester.storage.storageClass.label"),mode:a.mode,disabled:g.isDisabled,required:a.validateRequired},null,8,["value","options","label","mode","disabled","required","onUpdate:value"])])),_:1},8,["name","value","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(w,{name:e.t("harvester.fields.size"),value:a.value.size,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(E,{value:a.value.size,"onUpdate:value":[t[3]||(t[3]=e=>a.value.size=e),g.update],"output-modifier":!0,increment:1024,"input-exponent":3,mode:a.mode,required:a.validateRequired,label:e.t("harvester.fields.size"),disabled:g.isLonghornV2,suffix:y.GIBIBYTE},null,8,["value","mode","required","label","disabled","suffix","onUpdate:value"])])),_:1},8,["name","value","mode"])])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(w,{name:e.t("harvester.virtualMachine.volume.bus"),value:a.value.bus,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{value:a.value.bus,"onUpdate:value":[t[4]||(t[4]=e=>a.value.bus=e),g.update],label:e.t("harvester.virtualMachine.volume.bus"),mode:a.mode,options:y.InterfaceOption,required:""},null,8,["value","label","mode","options","onUpdate:value"])])),_:1},8,["name","value","mode"])]),g.showVolumeMode?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(w,{name:e.t("harvester.volume.volumeMode"),value:a.value.volumeMode,mode:a.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{value:a.value.volumeMode,"onUpdate:value":[t[5]||(t[5]=e=>a.value.volumeMode=e),g.update],label:e.t("harvester.volume.volumeMode"),mode:a.mode,options:g.volumeModeOptions,disabled:a.isEdit,required:""},null,8,["value","label","mode","options","disabled","onUpdate:value"])])),_:1},8,["name","value","mode"])])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("div",m,[a.value.volumeEncryptionFeatureEnabled&&g.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createVNode)(V,{name:e.t("harvester.virtualMachine.volume.encryption"),value:g.encryptionValue},null,8,["name","value"])])):(0,o.createCommentVNode)("",!0),a.value.volumeBackups&&g.isView?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createVNode)(V,{name:e.t("harvester.virtualMachine.volume.readyToUse"),value:g.readyToUse},null,8,["name","value"])])):(0,o.createCommentVNode)("",!0)])])}var y=a(61856),g=a(63418),b=a(78090),k=a(5327),w=a(77562),N=a(20665),E=a(49844),V=a(66905),S=a(71779),C=a(92552),x=a(41594),B=a(82877),U=a(15908),A=a(84757),M=a(41837),T={name:"HarvesterEditVolume",emits:["update"],components:{InputOrDisplay:b.A,Loading:y.A,LabeledInput:k.o,LabeledSelect:w.A,UnitInput:g.A,LabelValue:C.A},props:{mode:{type:String,default:"create"},isEdit:{type:Boolean,default:!1},namespace:{type:String,default:null},value:{type:Object,default:()=>({})},validateRequired:{type:Boolean,required:!0},isVirtualType:{type:Boolean,default:!0}},data(){return{GIBIBYTE:A.Wl,VOLUME_TYPE:V._w,InterfaceOption:V.$z,loading:!1}},computed:{longhornV2LVMSupport(){return this.$store.getters["harvester-common/getFeatureEnabled"]("longhornV2LVMSupport")},thirdPartyStorageClassEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("thirdPartyStorage")},encryptionValue(){return(0,x.TF)(String(this.value.isEncrypted))},readyToUse(){const e=String(this.value.volumeBackups?.readyToUse||!1);return(0,x.TF)(e)},isView(){return this.mode===S.nW},pvcsResource(){const e=this.$store.getters["harvester/all"](N.YH)||[];return e.find((e=>e.id===`${this.namespace}/${this.value.volumeName}`))},showVolumeMode(){return!(!this.thirdPartyStorageClassEnabled||!1===!!this.value?.storageClassName)&&!this.isLonghornStorageClass},isDisabled(){return!this.value.newCreateId&&this.isEdit&&this.isVirtualType},storageClasses(){return this.$store.getters["harvester/all"](N.fJ)||[]},storageClassOptions(){return this.storageClasses.filter((e=>!e.parameters?.backingImage)).map((e=>{const t=e.isDefault?`${e.name} (${this.t("generic.default")})`:e.name;return{label:t,value:e.name}}))||[]},isLonghornV2(){return this.value.pvc?.isLonghornV2||this.value.pvc?.storageClass?.isLonghornV2},isLonghornStorageClass(){const e=this.storageClasses.find((e=>e.name===this.value?.storageClassName))||{};return e&&e.isLonghorn},volumeModeOptions(){return Object.values(M.vU)}},watch:{"value.storageClassName":{immediate:!0,handler(e){this.value.accessMode=this.getAccessMode(e),this.value.volumeMode=this.getVolumeMode(e,this.value.volumeMode),this.update()}},"value.type"(e){"cd-rom"===e&&(this.value["bus"]="sata",this.update())},pvcsResource:{handler(e){if(e?.spec?.resources?.requests?.storage){const t=(0,E.ao)(e.spec.resources.requests.storage),a=(0,E.Mo)(t,{increment:1024,addSuffix:!1,maxExponent:3,minExponent:3});this.value.size=`${a}${A.Wl}`}},deep:!0,immediate:!0}},methods:{getVolumeMode(e,t){if(!this.thirdPartyStorageClassEnabled)return M.vU.BLOCK;const a=this.storageClasses.find((t=>t.name===e));return a&&a.isLonghorn?M.vU.BLOCK:t},getAccessMode(e){if(!this.longhornV2LVMSupport)return"ReadWriteMany";const t=this.storageClasses.find((t=>t.name===e));let a=this.value.pvc?.isLvm||!this.thirdPartyStorageClassEnabled&&this.value.pvc?.isLonghornV2;return t&&(a=t.provisioner===B.LVM_DRIVER||!this.thirdPartyStorageClassEnabled&&t.parameters?.dataEngine===U.DATA_ENGINE_V2),a?"ReadWriteOnce":"ReadWriteMany"},update(){this.$emit("update")}}},I=a(47433);const L=(0,I.A)(T,[["render",f]]);var O=L},43489:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".node-selector{position:relative}",""]),t["default"]=n},70684:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,'.toggle-container[data-v-2d3cf8f2]{align-items:center;display:flex}.toggle-container span[data-v-2d3cf8f2]:first-child{padding-right:6px}.toggle-container span[data-v-2d3cf8f2]:last-child{padding-left:6px}.switch[data-v-2d3cf8f2]{position:relative;display:inline-block;width:48px;height:24px}.switch input[data-v-2d3cf8f2]{opacity:0;width:0;height:0}.slider[data-v-2d3cf8f2]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--checkbox-disabled-bg);transition:.4s}.slider.focus[data-v-2d3cf8f2]{outline:2px solid var(--primary-keyboard-focus);outline-offset:2px;transition:0s}.slider[data-v-2d3cf8f2]:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:var(--checkbox-tick);transition:.4s}input:checked+.slider[data-v-2d3cf8f2]{background-color:var(--checkbox-ticked-bg)}input:focus+.slider[data-v-2d3cf8f2]{box-shadow:0 0 1px var(--checkbox-ticked-bg)}input:checked+.slider[data-v-2d3cf8f2]:before{transform:translateX(24px)}.slider.round[data-v-2d3cf8f2]{border-radius:34px}.slider.round[data-v-2d3cf8f2]:before{border-radius:50%}',""]),t["default"]=n},28871:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".label[data-v-4d61bb36]{display:flex;flex-direction:column}.label .value[data-v-4d61bb36]{font-size:14px;line-height:18px}",""]),t["default"]=n},29251:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".label[data-v-7bbb54b8]{display:flex;flex-direction:column}.label .value[data-v-7bbb54b8]{font-size:14px;line-height:18px}",""]),t["default"]=n},74219:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".key-value{width:100%}.key-value .file-selector.role-link{text-transform:none;padding:0}.key-value .kv-container{display:grid;align-items:center;-moz-column-gap:20px;column-gap:20px}.key-value .kv-container label{margin-bottom:0}.key-value .kv-container .kv-item{width:100%;margin:10px 0 10px 0}.key-value .kv-container .kv-item.extra,.key-value .kv-container .kv-item.key{align-self:flex-start}.key-value .kv-container .kv-item.value .value-container.upload-button{position:relative;display:flex;justify-content:right;align-items:center}.key-value .kv-container .kv-item.value .value-container .file-selector{position:absolute;margin-right:5px}.key-value .kv-container .kv-item.value textarea{padding:10px 10px 10px 10px}.key-value .kv-container .kv-item .text-monospace:not(.conceal){font-family:monospace,monospace}.key-value .row,.key-value .rowgroup{display:grid;grid-column-start:1;grid-column-end:span end;grid-template-columns:subgrid}.key-value .row:before{display:none}.key-value .remove{text-align:center}.key-value .remove BUTTON{padding:0}.key-value .title{margin-bottom:10px}.key-value .title .read-from-file{float:right}.key-value input{height:40px;line-height:1}.key-value .footer .protip{float:right;padding:5px 0}.key-value .download{text-align:right}.key-value .copy-value{padding:0 0 0 10px}",""]),t["default"]=n},75084:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".labels__header[data-v-bcf64458]{display:flex;justify-content:space-between}",""]),t["default"]=n},49993:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".operator .vs__dropdown-option[data-v-7b79099a]{padding:3px 6px 3px 6px!important}.remove-expression[data-v-7b79099a]{padding:8px;position:absolute;margin-bottom:10px;right:0;top:0;z-index:2}.remove-expression i[data-v-7b79099a]{font-size:2em}.remove-container[data-v-7b79099a]{display:flex;justify-content:center}.match-expression-header[data-v-7b79099a],.match-expression-row[data-v-7b79099a]{display:grid;grid-template-columns:1fr 1fr 1fr;margin:5px 0;grid-gap:1.75%}.match-expression-header>LABEL[data-v-7b79099a],.match-expression-row>LABEL[data-v-7b79099a]{margin:0}.match-expression-header[data-v-7b79099a]:not(.view),.match-expression-row[data-v-7b79099a]:not(.view){grid-template-columns:repeat(3,1fr) 50px}.match-expression-row>div>input[data-v-7b79099a]{min-height:40px!important}.match-expression-header-matching[data-v-7b79099a],.match-expression-row-matching[data-v-7b79099a]{grid-template-columns:1fr 1fr 1fr 1fr}.match-expression-header-matching[data-v-7b79099a]:not(.view),.match-expression-row-matching[data-v-7b79099a]:not(.view){grid-template-columns:1fr 1fr 1fr 1fr 100px}",""]),t["default"]=n},11585:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".password[data-v-39697410]{display:flex;flex-direction:column}.password .labeled-input .addon[data-v-39697410]{display:flex;align-items:center;justify-content:center;padding-left:12px;min-width:65px}.password .labeled-input .addon .hide-show[data-v-39697410]:focus-visible{outline:2px solid var(--primary-keyboard-focus);outline-offset:4px}.password .genPassword[data-v-39697410]{display:flex;justify-content:flex-end}",""]),t["default"]=n},69429:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".addon.with-tooltip[data-v-3c2f5c19]{padding-right:42px}",""]),t["default"]=n},19044:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".vm__credentials-users .hasUsers.labeled-select.edit.taggable .labeled-tooltip .icon.status-icon{top:30px}",""]),t["default"]=n},67647:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".volume-source[data-v-61977bc4]{position:relative}.remove-vol[data-v-61977bc4]{position:absolute;top:10px;right:10px;padding:0}",""]),t["default"]=n},34213:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".action[data-v-7d19b7bd]{display:flex;flex-direction:row-reverse}",""]),t["default"]=n},67381:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,"[data-v-1613a356]  .resource-yaml{flex:1;display:flex;flex-direction:column}[data-v-1613a356]  .resource-yaml .yaml-editor{flex:1;min-height:200px}[data-v-1613a356]  .resource-yaml .yaml-editor .code-mirror .CodeMirror{min-height:200px}",""]),t["default"]=n},47905:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".yaml[data-v-2d3a6d84]{height:350px;overflow:auto}[data-v-2d3a6d84]  .resource-yaml{flex:1;display:flex;flex-direction:column}[data-v-2d3a6d84]  .resource-yaml .yaml-editor{flex:1;min-height:350px}[data-v-2d3a6d84]  .resource-yaml .yaml-editor .code-mirror .CodeMirror{min-height:350px}",""]),t["default"]=n},87582:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".infoBox[data-v-697c87ca]{position:relative}.remove-vol[data-v-697c87ca]{position:absolute;top:10px;right:16px;padding:0;max-height:28px;min-height:28px}",""]),t["default"]=n},64311:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),s=a(40935),r=a.n(s),n=r()(l());n.push([e.id,".box[data-v-494be023]{position:relative}.title[data-v-494be023]{display:flex}.title .state[data-v-494be023]{font-size:16px}.remove[data-v-494be023]{position:absolute;top:10px;right:10px;padding:0}.bootOrder[data-v-494be023]{display:flex;align-items:center}.buttons[data-v-494be023]{width:100%;display:flex;justify-content:flex-end}.volume-status[data-v-494be023]:first-letter{text-transform:uppercase}.resource-external[data-v-494be023]{display:flex;justify-content:center;align-items:center}.banner[data-v-494be023]{margin:10px 0}",""]),t["default"]=n},154:function(e,t,a){"use strict";var o=a(26812);t.A={computed:{conditions(){return this.value?.conditions||[]},readyCondition(){return(0,o.cy)(this.conditions)?(0,o.jq)(this.conditions,"type","Ready")||{}:this.conditions.Ready},schedulableCondition(){return(0,o.cy)(this.conditions)?(0,o.jq)(this.conditions,"type","Schedulable")||{}:this.conditions.Schedulable}}}},76906:function(e,t,a){var o=a(43489);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("6a77e7a8",o,!0,{sourceMap:!1,shadowMode:!1})},52124:function(e,t,a){var o=a(70684);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("5be751ae",o,!0,{sourceMap:!1,shadowMode:!1})},59335:function(e,t,a){var o=a(28871);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("2f809f0d",o,!0,{sourceMap:!1,shadowMode:!1})},41347:function(e,t,a){var o=a(29251);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("6fe3baab",o,!0,{sourceMap:!1,shadowMode:!1})},51403:function(e,t,a){var o=a(74219);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("4f4b9a3b",o,!0,{sourceMap:!1,shadowMode:!1})},21292:function(e,t,a){var o=a(75084);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("e254067a",o,!0,{sourceMap:!1,shadowMode:!1})},22281:function(e,t,a){var o=a(49993);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("4506056d",o,!0,{sourceMap:!1,shadowMode:!1})},4961:function(e,t,a){var o=a(11585);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("acb19718",o,!0,{sourceMap:!1,shadowMode:!1})},62869:function(e,t,a){var o=a(69429);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("81f2551a",o,!0,{sourceMap:!1,shadowMode:!1})},84388:function(e,t,a){var o=a(19044);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("32886c2c",o,!0,{sourceMap:!1,shadowMode:!1})},38239:function(e,t,a){var o=a(67647);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("9e59092a",o,!0,{sourceMap:!1,shadowMode:!1})},27461:function(e,t,a){var o=a(34213);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("05d24086",o,!0,{sourceMap:!1,shadowMode:!1})},71157:function(e,t,a){var o=a(67381);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("df2188a2",o,!0,{sourceMap:!1,shadowMode:!1})},9729:function(e,t,a){var o=a(47905);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("5e97709f",o,!0,{sourceMap:!1,shadowMode:!1})},89982:function(e,t,a){var o=a(87582);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("6b7d4a78",o,!0,{sourceMap:!1,shadowMode:!1})},82583:function(e,t,a){var o=a(64311);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("7bdaad53",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=harvester-1.5.0-rc5.umd.min.525.js.map